<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="UTF-8"><META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
<link rel="canonical" href="https://doc.ntp.org/documentation/3-5.93e/driver8/" />
  
  <meta property="og:title" content="Generic Reference Driver" />
<meta property="og:description" content="Table of Contents  Synopsis Description ntpq (8) Timecode Variables Monitor Data Fudge Factors Making your own PARSE clocks Additional Information   Synopsis  Address: 127.127.8.u Reference ID: PARSE Driver ID: GENERIC Serial Port: /dev/refclock-u; TTY mode according to clock type Features: ppsclock   Description The timecode of these receivers is sampled via a STREAMS module in the kernel (The STREAMS module has been designed for use with SUN Systems under SunOS 4." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://doc.ntp.org/documentation/3-5.93e/driver8/" /><meta property="og:image" content="https://doc.ntp.org/images/sundial.jpg"/><meta property="article:section" content="documentation" />

<meta property="article:modified_time" content="2022-05-04T17:05:38&#43;01:00" /><meta property="og:site_name" content="NTP: Network Time Protocol" />

<script async src="https://www.googletagmanager.com/gtag/js?id=G-BN61ZTDHBP"></script>
<script>
var doNotTrack = true;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-BN61ZTDHBP', { 'anonymize_ip': true });
}
</script>


  
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700,800,800i,900i&display=swap" rel="stylesheet"/>
   
  <title>Generic Reference Driver</title>

  <!-- Mobile Responsive Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="The NTP Project conducts Research and Development in NTP, a protocol designed to synchronize the clocks of computers over a network to a common timebase.">
  
  <meta name="generator" content="Hugo 0.83.1" />

  <!-- Plugins -->
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://doc.ntp.org/scss/nwtime.min.d583f4e59d35207a473045a722afed7a.css" media="screen">

  <!-- Favicon -->
  <link rel="shortcut icon" href="https://doc.ntp.org/favicons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="https://doc.ntp.org/favicons/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/android-chrome-512x512.png" sizes="512x512"></head>
<body><!-- navigation -->

<nav class="navbar navbar-expand-lg navbar-light">
  <div class="container-fluid">


	<div>
	  <a class="navbar-brand" href="https://www.nwtime.org"><img height="80" width="80" src="https://doc.ntp.org/images/logo.png" alt=""></a>
	  <a class="navbar-brand" href="https://doc.ntp.org/"><img height="80" width="80" src="https://doc.ntp.org/images/ntp_logo.jpg" alt="NTP: Network Time Protocol"></a> 
    </div>


    <div>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://doc.ntp.org/support/">Support</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://doc.ntp.org/reflib/">Reference Library</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://doc.ntp.org/documentation/">Documentation</a>
        </button>
      
    </div>



<script async src="https://cse.google.com/cse.js?cx=bb3c9b3e375d856be"></script>
  <div class="gcse-search">
  </div>

</nav>


  <div class="header-border">
  </div>
<!-- /navigation --><nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="https://doc.ntp.org/documentation/">Documentation</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://doc.ntp.org/documentation/3-5.93e/">3-5.93e</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://doc.ntp.org/documentation/3-5.93e/driver8/">Generic Reference Driver</a>
</li>

	</ol>
</nav	>


<section class="section pt-0  pb-auto">
  <div class="container">
  	<h1>Generic Reference Driver</h1>
     
    <p style="font-size: small; color: grey;">Last update: May 4, 2022 17:05 UTC (<a href="https://bitbucket.nwtime.org/projects/WEBSITES/repos/ntpwww/commits/dbea9b7d4daf047a65cdfd64d621e7efa23484da">dbea9b7d4</a>)</p>
	<h4 id="table-of-contents">Table of Contents</h4>
<ul>
<li><a href="https://doc.ntp.org/documentation/3-5.93e/driver8/#synopsis">Synopsis</a></li>
<li><a href="https://doc.ntp.org/documentation/3-5.93e/driver8/#description">Description</a></li>
<li><a href="https://doc.ntp.org/documentation/3-5.93e/driver8/#ntpq-8-timecode-variables">ntpq (8) Timecode Variables</a></li>
<li><a href="https://doc.ntp.org/documentation/3-5.93e/driver8/#monitor-data">Monitor Data</a></li>
<li><a href="https://doc.ntp.org/documentation/3-5.93e/driver8/#fudge-factors">Fudge Factors</a></li>
<li><a href="https://doc.ntp.org/documentation/3-5.93e/driver8/#making-your-own-parse-clocks">Making your own PARSE clocks</a></li>
<li><a href="https://doc.ntp.org/documentation/3-5.93e/driver8/#additional-information">Additional Information</a></li>
</ul>
<hr>
<h4 id="synopsis">Synopsis</h4>
<dl>
<dt><strong>Address:</strong> <code>127.127.8.<em>u</em></code></dt>
<dd><strong>Reference ID:</strong> <code>PARSE</code></dd>
<dd><strong>Driver ID:</strong> <code>GENERIC</code></dd>
<dd><strong>Serial Port:</strong> <code>/dev/refclock-<em>u</em>;</code> TTY mode according to clock type</dd>
<dd><strong>Features:</strong> <code>ppsclock</code></dd>
</dl>
<hr>
<h4 id="description">Description</h4>
<p>The timecode of these receivers is sampled via a STREAMS module in the kernel (The STREAMS module has been designed for use with SUN Systems under SunOS 4.1.x or Solaris 2.3. It can be linked directly into the kernel or loaded via the loadable driver mechanism). This STREAMS module can be adapted to be able to convert different time code formats. If the daemon is compiled without the STREAM definition synchronization will work without the Sun streams module, though accuracy is significantly degraded. This feature allows to use PARSE also on non Sun machines.</p>
<p>The actual receiver status is mapped into various synchronization states generally used by receivers. The STREAMS module is configured to interpret the time codes of DCF U/A 31, PZF535, GPS166, Trimble SV6 GPS, ELV DCF7000, Schmid and low cost receivers (see list below).</p>
<p>The reference clock support in xntp contains the necessary configuration tables for those receivers. In addition to supporting several different clock types and 4 devices, the generation of a PPS signal is also provided as a configuration option. The PPS configuration option uses the receiver generated time stamps for feeding the PPS loopfilter control for much finer clock synchronization.</p>
<blockquote>
<p>CAUTION: The PPS configuration option is different from the hardware PPS signal, which is also supported (see below), as it controls the way <code>xntpd</code> is synchronized to the reference clock, while the hardware PPS signal controls the way time offsets are determined.</p>
</blockquote>
<p>The use of the PPS option requires receivers with an accuracy of better than 1ms.</p>
<p>Only two fudge factors are utilized. The <code>time1</code> fudge factor defines the phase offset of the synchronization character to the actual time. On the availability of PPS information the <code>time2</code> fudge factor defines the skew between the PPS time stamp and the receiver timestamp of the PPS signal. This parameter is usually zero, as usually the PPS signal is believed in time and OS delays should be corrected in the machine specific section of the kernel driver. <code>time2</code> needs only be set when the actual PPS signal is delayed for some reason. The <code>flag1</code> enables input filtering. This a median filter with continuous sampling. The <code>flag2</code> selects averaging of the samples remaining after the filtering. Leap second-handling is controlled with the <code>flag3</code>. When set a leap second will be deleted on receipt of a leap second indication from the receiver. Otherwise the leap second will be added, (which is the default). <code>flag3</code> should never be set. PPS handling is enabled by adding 128 to the mode parameter in the <code>server/peer</code> command.</p>
<hr>
<h4 id="ntpq-8-timecode-variables">ntpq (8) Timecode Variables</h4>
<p>The <code>ntpq</code> program can read clock variables command list several variables. These hold the following information: <code>refclock_time</code> is the local time with the offset to UTC (format <code>HHMM</code>). The currently active receiver flags are listed in <code>refclock_status</code>. Additional feature flags of the receiver are optionally listed in parentheses. The actual time code is listed in <code>timecode</code>. A qualification of the decoded time code format is following in <code>refclock_format</code>. The last piece of information is the overall running time and the accumulated times for the clock event states in <code>refclock_states</code>. When PPS information is present additional variable are available. <code>refclock_ppstime</code> lists then the PPS timestamp and <code>refclock_ppsskew</code> lists the difference between RS232 derived timestamp and the PPS timestamp.</p>
<p>Currently, fourteen clock types (devices <code>/dev/refclock-0</code> - <code>/dev/refclock-3</code>) are supported by the PARSE driver.</p>
<ul>
<li>server 127.127.8.0-3 mode 0<br>
Meinberg PZF535 receiver (FM demodulation/TCXO / 50us)</li>
<li>server 127.127.8.0-3 mode 1<br>
Meinberg PZF535 receiver (FM demodulation/OCXO / 50us)</li>
<li>server 127.127.8.0-3 mode 2<br>
Meinberg DCF U/A 31 receiver (AM demodulation / 4ms)</li>
<li>server 127.127.8.0-3 mode 3<br>
ELV DCF7000 (sloppy AM demodulation / 50ms)</li>
<li>server 127.127.8.0-3 mode 4<br>
Walter Schmid DCF receiver Kit (AM demodulation / 1ms)</li>
<li>server 127.127.8.0-3 mode 5<br>
RAW DCF77 100/200ms pulses (Conrad DCF77 receiver module / 5ms)</li>
<li>server 127.127.8.0-3 mode 6<br>
RAW DCF77 100/200ms pulses (TimeBrick DCF77 receiver module / 5ms)</li>
<li>server 127.127.8.0-3 mode 7<br>
Meinberg GPS166 receiver (GPS / &laquo;1us)</li>
<li>server 127.127.8.0-3 mode 8<br>
IGEL clock</li>
<li>server 127.127.8.0-3 mode 9<br>
Trimble SV6 GPS receiver TAIP protocol (GPS / &laquo;1us)</li>
<li>server 127.127.8.0-3 mode 10<br>
Trimble SV6 GPS receiver TSIP protocol (GPS / &laquo;1us) (no kernel support yet)</li>
<li>server 127.127.8.0-3 mode 11<br>
Radiocode Clocks Ltd RCC 8000 Intelligent Off-Air Master Clock support</li>
<li>server 127.127.8.0-3 mode 12<br>
HOPF Funkuhr 6021</li>
<li>server 127.127.8.0-3 mode 13<br>
Diem&rsquo;s Computime Radio Clock</li>
</ul>
<p>Actual data formats and set-up requirements of the various clocks can be found in <a href="https://doc.ntp.org/documentation/3-5.93e/parsedata/">XNTP PARSE clock data formats</a>.</p>
<p>The reference clock support carefully monitors the state transitions of the receiver. All state changes and exceptional events such as loss of time code transmission are logged via the <code>syslog</code> facility. Every hour a summary of the accumulated times for the clock states is listed via <code>syslog</code>.</p>
<p>PPS support is only available when the receiver is completely synchronized. The receiver is believed to deliver correct time for an additional period of time after losing synchronizations, unless a disruption in time code transmission is detected (possible power loss). The trust period is dependent on the receiver oscillator and thus a function of clock type. This is one of the parameters in the <code>clockinfo</code> field of the reference clock implementation. This parameter cannot be configured by <code>xntpdc</code>.</p>
<p>In addition to the PPS loopfilter control a true PPS hardware signal can be applied on Sun Sparc stations via the CPU serial ports on the CD pin. This signal is automatically detected and will be used for offset calculation. The input signal must be the time mark for the following time code. (The edge sensitivity can be selected - look into the appropriate <code>kernel/parsestreams.c</code> for details). Meinberg receivers can be connected by feeding the PPS pulse of the receiver via a 1488 level converter to Pin 8 (CD) of a Sun serial zs-port. To select PPS support the STREAMS driver for PARSE must be loaded and the <code>mode</code> parameter is the mode value of above plus 128. If 128 is not added to the mode value PPS will be detected to be available but it will not be used. For PPS to be used you MUST add 128 to the <code>mode</code> parameter.</p>
<p>There exists a special firmware release for the PZF535 Meinberg receivers. This release (PZFUERL 4.6 (or higher - The UERL is important)) is absolutely recommended for XNTP use, as it provides LEAP warning, time code time zone information and alternate antenna indication. Please check with Meinberg for this firmware release. For the Meinberg GPS166 receiver is also a special firmware release available (Uni-Erlangen). This release must be used for proper operation.</p>
<p>The raw DCF77 pulses can be fed via a level converter directly into Pin 3 (Rx) of the Sun. The telegrams will be decoded an used for synchronization. AM DCF77 receivers are running as low as $25. The accuracy is dependent on the receiver and is somewhere between 2ms (expensive) to 10ms (cheap). Upon bad signal reception of DCF77 synchronizations will cease as no backup oscillator is available as usually found in other reference clock receivers. So it is important to have a good place for the DCF77 antenna. For transmitter shutdowns you are out of luck unless you have other NTP servers with alternate time sources available.</p>
<hr>
<h4 id="monitor-data">Monitor Data</h4>
<p>Clock state statistics are written hourly to the syslog service. Online information can be found by examining the clock variables via the <code>ntpq cv</code> command.</p>
<hr>
<h4 id="fudge-factors">Fudge Factors</h4>
<dl>
<dt><code><strong>time1 <em>time</em></strong></code></dt>
<dd>
<p>Specifies the time offset calibration factor, in seconds and fraction, with default depending on clock type.</p>
</dd>
<dt><code><strong>time2 <em>time</em></strong></code></dt>
<dd>
<p>Specifies the offset if the PPS signal to the actual time. (PPS fine tuning).</p>
</dd>
<dt><code><strong>stratum <em>number</em></strong></code></dt>
<dd>
<p>Specifies the driver stratum, in decimal from 0 to 15, with default 0.</p>
</dd>
<dt><code><strong>refid <em>string</em></strong></code></dt>
<dd>
<p>Specifies the driver reference identifier, an ASCII string from one to four characters, with default according to current clock type.</p>
</dd>
<dt><code><strong>flag1 0 | 1</strong></code></dt>
<dd>
<p>Not used by this driver.</p>
</dd>
<dt><code><strong>flag2 0 | 1</strong></code></dt>
<dd>
<p>Not used by this driver.</p>
</dd>
<dt><code><strong>flag3 0 | 1</strong></code></dt>
<dd>
<p>Delete next leap second instead of adding it.</p>
</dd>
<dt><code><strong>flag4 0 | 1</strong></code></dt>
<dd>
<p>Delete next leap second instead of adding it - flag will be re-defined soon - so don&rsquo;t use it. Statistics are provided by more common means (<code>syslog</code>, <code>clock</code> variable via <code>ntpq</code>).</p>
</dd>
</dl>
<hr>
<h4 id="making-your-own-parse-clocks">Making your own PARSE clocks</h4>
<p>The parse clock mechanism is deviated from the way other xntp reference clocks work. For a short description of how to build parse reference clocks, see <a href="https://doc.ntp.org/documentation/3-5.93e/parsenew/">making PARSE clocks</a>.</p>
<hr>
<h4 id="additional-information">Additional Information</h4>
<p><a href="https://doc.ntp.org/documentation/3-5.93e/refclock/">Reference Clock Drivers</a></p>

	  
  </div>
</section>
<nav class="site-footer navbar navbar-expand-sm mt-auto">
  <div class="container">
      <ul class="navbar-nav">
        
        <li class="nav-item" title="Twitter" aria-label="Twitter">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ntp">
          <img src="https://doc.ntp.org/images/icons/twitter.svg" width="20" height="20"></img>
          </a>
       </li>
       
        <li class="nav-item" title="LinkedIn" aria-label="LinkedIn">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/groups/4651343">
          <img src="https://doc.ntp.org/images/icons/linkedin.svg" width="20" height="20"></img>
          </a>
       </li>
       
        <li class="nav-item" title="Facebook" aria-label="Facebook">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/networktimeprotocol">
          <img src="https://doc.ntp.org/images/icons/facebook.svg" width="20" height="20"></img>
          </a>
       </li>
       
	  </ul>
	  <ul class="mx-auto pt-3">
        <p>&copy; 2022 <a class="navbar-text text-white" href="https://www.nwtime.org/">Network Time Foundation</a></p>	
      </ul>
    </div>
</nav>
</body>
</html>