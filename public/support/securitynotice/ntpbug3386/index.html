<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="UTF-8">
  <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">

  
  <meta name="description" content="
Summary

  
	
		Resolved
		4.2.8p10
		21 Mar 2017
	
	
		References
		Bug 3386
		
	
	
		Affects
		All versions of NTP, up to but not â€¦">
<meta property="og:title" content="NTP BUG 3386: ntpq_stripquotes() returns incorrect value" />
<meta property="og:description" content="Summary Resolved4.2.8p1021 Mar 2017ReferencesBug 3386AffectsAll versions of NTP, up to but not including ntp-4.2.8p10,
and ntp-4.3.0 up to, but not including ntp-4.3.94.Resolved in 4.2.8p10.CVSS2 ScoreNONE 0.0AV:N/AC:H/Au:N/C:N/I:N/A:NCVSS3 ScoreNONE 0.0CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:N		 Description The NTP Mode 6 monitoring and control client, ntpq, uses the function ntpq_stripquotes() to remove quotes and escape characters from a given string." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://doc.ntp.org/support/securitynotice/ntpbug3386/" /><meta property="article:section" content="support" />
<meta property="article:published_time" content="2017-03-21T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2017-03-21T00:00:00&#43;00:00" /><meta property="og:site_name" content="NTP: Network Time Protocol" />



<script async src="https://www.googletagmanager.com/gtag/js?id=G-BN61ZTDHBP"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-BN61ZTDHBP', { 'anonymize_ip': false });
}
</script>


  
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700,800,800i,900i&display=swap" rel="stylesheet"/>
   
  <title>NTP BUG 3386: ntpq_stripquotes() returns incorrect value</title>

  <!-- Mobile Responsive Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  
  <meta name="generator" content="Hugo 0.83.1" />

  <!-- Plugins -->
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://doc.ntp.org/scss/nwtime.min.d583f4e59d35207a473045a722afed7a.css" media="screen">

  <!-- Favicon -->
  <link rel="shortcut icon" href="https://doc.ntp.org/favicons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="https://doc.ntp.org/favicons/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/android-chrome-512x512.png" sizes="512x512"></head>
<body><!-- navigation -->

<nav class="navbar navbar-expand-lg navbar-light">
  <div class="container-fluid">


	<div>
	  <a class="navbar-brand" href="https://www.nwtime.org"><img height="80" width="80" src="https://doc.ntp.org/images/logo.png" alt=""></a>
	  <a class="navbar-brand" href="https://doc.ntp.org/"><img height="80" width="80" src="https://doc.ntp.org/images/ntp_logo.jpg" alt="NTP: Network Time Protocol"></a> 
    </div>


    <div>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://doc.ntp.org/support/">Support</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://doc.ntp.org/reflib/">Reference Library</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://doc.ntp.org/documentation/">Documentation</a>
        </button>
      
    </div>


<script async src="https://cse.google.com/cse.js?cx=bb3c9b3e375d856be"></script>
  <div class="gcse-search">
  </div>
</nav>


  <div class="header-border">
  </div>
<!-- /navigation --><nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="https://doc.ntp.org/support/">Support</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://doc.ntp.org/support/securitynotice/">Security</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://doc.ntp.org/support/securitynotice/ntpbug3386/">NTP BUG 3386: ntpq_stripquotes() returns incorrect value</a>
</li>

	</ol>
</nav	>


<section class="section pt-0  pb-auto">
  <div class="container">
  	<h1>NTP BUG 3386: ntpq_stripquotes() returns incorrect value</h1>
     
    <hr>
<h4 id="summary">Summary</h4>
<table>
  <tbody>
	<tr>
		<th><b>Resolved</b></th>
		<td><a href="/support/securitynotice/4_2_8p10-release-announcement/">4.2.8p10</a></td>
		<td>21 Mar 2017</td>
	</tr>
	<tr>
		<th><b>References</b></th>
		<td><a href="https://bugs.ntp.org/show_bug.cgi?id=3386">Bug 3386</a></td>
		<td></td>
	</tr>
	<tr>
		<th><b>Affects</b></th>
		<td>All versions of NTP, up to but not including ntp-4.2.8p10,<br> and ntp-4.3.0 up to, but not including ntp-4.3.94.</td>
		<td>Resolved in 4.2.8p10.</td>
	</tr>
	<tr>
		<th><b>CVSS2 Score</b></th>
		<td>NONE 0.0</td>
		<td><a href="https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?calculator&version=2.0&vector=(AV:N/AC:H/Au:S/C:N/I:N/A:N)">AV:N/AC:H/Au:N/C:N/I:N/A:N</a></td>
	</tr>
	<tr>
		<th><b>CVSS3 Score<b></th>
		<td>NONE 0.0</td>
		<td><a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:N">CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:N</a></td>
	</tr>	
  </tbody>	
</table>
<hr>
<h4 id="description">Description</h4>
<p>The NTP Mode 6 monitoring and control client, <code>ntpq</code>, uses the function <code>ntpq_stripquotes()</code> to remove quotes and escape characters from a given string. According to the documentation, the function is supposed to return the number of copied bytes but due to incorrect pointer usage this value is always zero. Although the return value of this function is never used in the code, this flaw could lead to a vulnerability in the future. Since relying on wrong return values when performing memory operations is a dangerous practice, it is recommended to return the correct value in accordance with the documentation pertinent to the code.</p>
<hr>
<h4 id="mitigation">Mitigation</h4>
<ul>
<li>Implement <a href="http://www.bcp38.info/index.php/Main_Page">BCP-38</a>.</li>
<li>Upgrade to <a href="/downloads/">4.2.8p10 or later.</a></li>
<li>Properly monitor your <code>ntpd</code> instances, and auto-restart <code>ntpd</code> (without <code>-g</code>) if it stops running.</li>
</ul>
<hr>
<h4 id="credit">Credit</h4>
<p>This weakness was discovered by Cure53.</p>
<hr>
<h4 id="timeline">Timeline</h4>
<ul>
<li>2017 Mar 21: Public release</li>
<li>2017 Mar 06: <a href="https://www.nwtime.org/membership/benefits/">Early Access Program Release: Premier and Partner Institutional Members</a></li>
<li>2017 Mar 06: <a href="https://www.nwtime.org/membership/benefits/">Notification to Institutional Members</a></li>
<li>2017 Feb 09: Mozilla/Cure53 audit received</li>
</ul>

	  
	  <style>
  .feedback--answer {
    display: inline-block;
  }
  .feedback--answer-no {
    margin-left: 1em;
  }
  .feedback--response {
    display: none;
    margin-top: 1em;
  }
  .feedback--response__visible {
    display: block;
  }
</style>
<div>
<h2 class="feedback--title">Feedback</h2>
<p class="feedback--question">Was this page helpful?</p>
<button class="btn-primary mb-5 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn-primary mb-5 feedback--answer feedback--answer-no">No</button>
<p class="feedback--response feedback--response-yes">
  Glad to hear it!</a>
</p>
<p class="feedback--response feedback--response-no">
  Sorry to hear that.</a>
</p>
</div>
<script>
  const yesButton = document.querySelector('.feedback--answer-yes');
  const noButton = document.querySelector('.feedback--answer-no');
  const yesResponse = document.querySelector('.feedback--response-yes');
  const noResponse = document.querySelector('.feedback--response-no');
  const disableButtons = () => {
    yesButton.disabled = true;
    noButton.disabled = true;
  };
  const sendFeedback = (value) => {
    if (typeof ga !== 'function') return;
    const args = {
      command: 'send',
      hitType: 'event',
      category: 'Helpful',
      action: 'click',
      label: window.location.pathname,
      value: value
    };
    ga(args.command, args.hitType, args.category, args.action, args.label, args.value);
  };
  yesButton.addEventListener('click', () => {
    yesResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(1);
  });
  noButton.addEventListener('click', () => {
    noResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(0);
  });
</script>

	  <br />
	
  </div>
</section>
<nav class="site-footer navbar navbar-expand-sm mt-auto">
  <div class="container">
      <ul class="navbar-nav">
        
        <li class="nav-item" title="Twitter" aria-label="Twitter">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ntp">
          <img src="/images/icons/twitter.svg" width="20" height="20"></img>
          </a>
       </li>
       
        <li class="nav-item" title="LinkedIn" aria-label="LinkedIn">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/groups/4651343">
          <img src="/images/icons/linkedin.svg" width="20" height="20"></img>
          </a>
       </li>
       
        <li class="nav-item" title="Facebook" aria-label="Facebook">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/networktimeprotocol">
          <img src="/images/icons/facebook.svg" width="20" height="20"></img>
          </a>
       </li>
       
	  </ul>
	  <ul class="mx-auto pt-3">
        <p>&copy; 2022 <a class="navbar-text text-white" href="https://www.nwtime.org/">Network Time Foundation</a></p>	
      </ul>
    </div>
</nav>
</body>
</html>