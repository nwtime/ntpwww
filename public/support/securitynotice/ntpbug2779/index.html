<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="UTF-8">
  <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW"><link rel="canonical" href="https://www.ntp.org/support/securitynotice/ntpbug2779/" />
  
  <meta property="og:title" content="NTP BUG 2779: ntpd accepts unauthenticated packets with symmetric key crypto" />
<meta property="og:description" content="Packets without a MAC are accepted as if they had a valid MAC. This allows a MITM attacker to send false packets that are accepted by the client/peer without having to know the symmetric key. This bug was resolved in NTP 4.2.8p2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.ntp.org/support/securitynotice/ntpbug2779/" /><meta property="og:image" content="https://www.ntp.org/images/NTPLogo800x418.webp"/><meta property="article:section" content="support" />
<meta property="article:published_time" content="2015-04-07T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-02-15T20:59:32&#43;00:00" /><meta property="og:site_name" content="NTP: Network Time Protocol" />



<script async src="https://www.googletagmanager.com/gtag/js?id=G-K07ZJQFYSZ"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-K07ZJQFYSZ', { 'anonymize_ip': true });
</script>





<script>
window.onload = demo;
function demo() {
    document.getElementById("gsc-i-id1").setAttribute("placeholder", "Search...")
}
</script>


<script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "c33igkoodm");
</script>


  
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700,800,800i,900i&display=swap" rel="stylesheet"/>
   
  <title>NTP BUG 2779: ntpd accepts unauthenticated packets with symmetric key crypto</title>

  <!-- Mobile Responsive Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Packets without a MAC are accepted as if they had a valid MAC. This allows a MITM attacker to send false packets that are accepted by the client/peer without having to know the symmetric key. This bug was resolved in NTP 4.2.8p2.">
  
  <meta name="generator" content="Hugo 0.83.1" />

  <!-- Plugins -->
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://www.ntp.org/scss/nwtime.min.1de55a903767bacfaee426f1958345df.css" media="screen">

  <!-- Favicon -->
  <link rel="shortcut icon" href="https://www.ntp.org/favicons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="https://www.ntp.org/favicons/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" type="image/png" href="https://www.ntp.org/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="https://www.ntp.org/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://www.ntp.org/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="https://www.ntp.org/favicons/android-chrome-512x512.png" sizes="512x512"></head>
<body><!-- navigation -->

<nav class="navbar navbar-expand-lg navbar-light">
  <div class="container-fluid">


	<div>
	  <a class="navbar-brand" href="https://www.nwtime.org"><img height="80" width="80" src="https://www.ntp.org/images/logo.png" alt=""></a>
	  <a class="navbar-brand" href="https://www.ntp.org/"><img height="80" width="80" src="https://www.ntp.org/images/ntp_logo.jpg" alt="NTP: Network Time Protocol"></a> 
    </div>


    <div>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://www.ntp.org/support/">Support</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://www.ntp.org/reflib/">Reference Library</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://www.ntp.org/documentation/">Documentation</a>
        </button>
      
    </div>



<script async src="https://cse.google.com/cse.js?cx=bb3c9b3e375d856be"></script>
  <div class="gcse-search">
  </div>

</nav>


  <div class="header-border">
  </div>
<!-- /navigation --><nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="https://www.ntp.org/support/">Support</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://www.ntp.org/support/securitynotice/">Security</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://www.ntp.org/support/securitynotice/ntpbug2779/">NTP BUG 2779: ntpd accepts unauthenticated packets with symmetric key crypto</a>
</li>

	</ol>
</nav	>


<section class="section pt-0  pb-auto">
  <div class="container">
  	<h1>NTP BUG 2779: ntpd accepts unauthenticated packets with symmetric key crypto</h1> 
    <p style="font-size: small; color: grey;">Last update: February 15, 2022 20:59 UTC (<a href="https://bitbucket.nwtime.org/projects/WEBSITES/repos/ntpwww/commits/43fbd379b94302fc36da15f9ef895ef9e6676430">43fbd379b</a>)</p>
	<hr>
<h4 id="summary">Summary</h4>
<table>
  <tbody>
	<tr>
		<th><b>Resolved</b></th>
		<td><a href="https://www.ntp.org/support/securitynotice/4_2_8p2-release-announcement/">4.2.8p2</a></td>
		<td>07 Apr 2015</td>
	</tr>
	<tr>
		<th><b>References</b></th>
		<td><a href="https://bugs.ntp.org/show_bug.cgi?id=2779">Bug 2779</a></td>
		<td><a href="https://nvd.nist.gov/vuln/detail/CVE-2015-1798">CVE-2015-1798</a></td>
	</tr>
	<tr>
		<th><b>Affects</b></th>
		<td>All NTP4 releases starting with ntp-4.2.5p99 up to but not including ntp-4.2.8p2<br> where the installation uses symmetric keys to authenticate remote associations.</td>
		<td>Resolved in 4.2.8p2.</td>
	</tr>
	<tr>
		<th><b>CVSS2 Score</b></th>
		<td>5.4</td>
		<td><a href="https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?calculator&version=2.0&vector=(AV:A/AC:M/Au:N/C:P/I:P/A:P))">AV:A/AC:M/Au:N/C:P/I:P/A:P</a></td>
	</tr>	
  </tbody>	
</table>
<hr>
<h4 id="description">Description</h4>
<p>When <code>ntpd</code> is configured to use a symmetric key to authenticate a remote NTP server/peer, it checks if the NTP message authentication code (MAC) in received packets is valid, but not if there actually is any MAC included. Packets without a MAC are accepted as if they had a valid MAC. This allows a MITM attacker to send false packets that are accepted by the client/peer without having to know the symmetric key. The attacker needs to know the transmit timestamp of the client to match it in the forged reply and the false reply needs to reach the client before the genuine reply from the server. The attacker doesn&rsquo;t necessarily need to be relaying the packets between the client and the server.</p>
<p>Authentication using autokey doesn&rsquo;t have this problem as there is a check that requires the key ID to be larger than <code>NTP_MAXKEY</code>, which fails for packets without a MAC.</p>
<hr>
<h4 id="mitigation">Mitigation</h4>
<ul>
<li>Upgrade to <a href="https://www.ntp.org/downloads/">4.2.8p2 or later.</a></li>
<li>Configure <code>ntpd</code> with enough time sources and monitor it properly.</li>
</ul>
<hr>
<h4 id="credit">Credit</h4>
<p>This issue was discovered by Miroslav Lichvar, of Red Hat.</p>
<hr>
<h4 id="timeline">Timeline</h4>
<ul>
<li>2015 Apr 7: Public release</li>
<li>2015 Mar 22: <a href="https://www.nwtime.org/membership/benefits/">Early Access Program Release: Premier and Partner Institutional Members</a></li>
<li>2015 Mar 15: <a href="https://www.nwtime.org/membership/benefits/">Notification to Institutional Members</a></li>
<li>2015 Mar 6: Initial notification received; analysis begins</li>
</ul>

	  
  </div>
</section>
<nav class="site-footer navbar navbar-expand-sm mt-auto">
  <div class="container">
      <ul class="navbar-nav">
        
        <li class="nav-item" title="Twitter" aria-label="Twitter">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ntp">
          <img src="https://www.ntp.org/images/icons/twitter.svg" width="20" height="20"></img>
          </a>
       </li>
       
        <li class="nav-item" title="LinkedIn" aria-label="LinkedIn">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/groups/4651343">
          <img src="https://www.ntp.org/images/icons/linkedin.svg" width="20" height="20"></img>
          </a>
       </li>
       
        <li class="nav-item" title="Facebook" aria-label="Facebook">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/networktimeprotocol">
          <img src="https://www.ntp.org/images/icons/facebook.svg" width="20" height="20"></img>
          </a>
       </li>
       
	  </ul>
	  <ul class="mx-auto pt-3">
        <p>&copy; 2022 <a class="navbar-text text-white" href="https://www.nwtime.org/">Network Time Foundation</a></p>	
      </ul>
    </div>
</nav>
</body>
</html>