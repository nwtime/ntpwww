<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="UTF-8">
  <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">

  
  <meta name="description" content="
Summary

  
	
		Resolved
		4.2.8p5
		07 Jan 2016
	
	
		References
		Bug 2956
		CVE-2015-5300
	
	
		Affects
		All ntp-4 releases up to, â€¦">
<meta property="og:title" content="NTP BUG 2956: Small-step/big-step" />
<meta property="og:description" content="Summary Resolved4.2.8p507 Jan 2016ReferencesBug 2956CVE-2015-5300AffectsAll ntp-4 releases up to, but not including 4.2.8p5,
and 4.3.0 up to, but not including 4.3.78.Resolved in 4.2.8p5.CVSS2 ScoreMED 4.0AV:N/AC:H/PR:H/UI:R/S:C/C:L/I:N/A:L		 Description If ntpd is always started with the -g option, which is common and against long-standing recommendation, and if at the moment ntpd is restarted an attacker can immediately respond to enough requests from enough sources trusted by the target, which is difficult and not common, there is a window of opportunity where the attacker can cause ntpd to set the time to an arbitrary value." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://test.doc.ntp.org/support/securitynotice/ntpbug2956/" /><meta property="article:section" content="support" />
<meta property="article:published_time" content="2016-01-07T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2016-01-07T00:00:00&#43;00:00" /><meta property="og:site_name" content="NTP: Network Time Protocol" />




  
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700,800,800i,900i&display=swap" rel="stylesheet"/>
   
  <title>NTP BUG 2956: Small-step/big-step</title>

  <!-- Mobile Responsive Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  
  <meta name="generator" content="Hugo 0.83.1" />

  <!-- Plugins -->
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://test.doc.ntp.org/scss/nwtime.min.css" media="screen">

  <!-- Favicon -->
  <link rel="shortcut icon" href="https://test.doc.ntp.org/favicons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="https://test.doc.ntp.org/favicons/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" type="image/png" href="https://test.doc.ntp.org/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="https://test.doc.ntp.org/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://test.doc.ntp.org/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="https://test.doc.ntp.org/favicons/android-chrome-512x512.png" sizes="512x512"></head>
<body><!-- navigation -->

<nav class="navbar navbar-expand-lg navbar-light">
  <div class="container-fluid">


	<div>
	  <a class="navbar-brand" href="https://www.nwtime.org"><img height="80" width="80" src="https://test.doc.ntp.org/images/logo.png" alt=""></a>
	  <a class="navbar-brand" href="https://test.doc.ntp.org/"><img height="80" width="80" src="https://test.doc.ntp.org/images/ntp_logo.jpg" alt="NTP: Network Time Protocol"></a> 
    </div>


    <div>
      
		<button class="btn btn-light btn-lg" type="button" id="dropdownMenu2" aria-expanded="false"><a class="nav-item" style="text-decoration: none" href="https://test.doc.ntp.org/support">Support</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" id="dropdownMenu2" aria-expanded="false"><a class="nav-item" style="text-decoration: none" href="https://test.doc.ntp.org/reflib">Reference Library</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" id="dropdownMenu2" aria-expanded="false"><a class="nav-item" style="text-decoration: none" href="https://test.doc.ntp.org/documentation">Documentation</a>
        </button>
      
    </div>


<script async src="https://cse.google.com/cse.js?cx=bb3c9b3e375d856be"></script>
  <div class="gcse-search">
  </div>
</nav>


  <div class="header-border">
  </div>
<!-- /navigation --><nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="https://test.doc.ntp.org/support/">Support</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://test.doc.ntp.org/support/securitynotice/">Security</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://test.doc.ntp.org/support/securitynotice/ntpbug2956/">NTP BUG 2956: Small-step/big-step</a>
</li>

	</ol>
</nav	>


<section class="section pt-0  pb-auto">
  <div class="container">
  	<h1>NTP BUG 2956: Small-step/big-step</h1>
     
    <hr>
<h4 id="summary">Summary</h4>
<table>
  <tbody>
	<tr>
		<th><b>Resolved</b></th>
		<td><a href="/support/securitynotice/4_2_8p5-release-announcement/">4.2.8p5</a></td>
		<td>07 Jan 2016</td>
	</tr>
	<tr>
		<th><b>References</b></th>
		<td><a href="https://bugs.ntp.org/show_bug.cgi?id=2956">Bug 2956</a></td>
		<td><a href="https://nvd.nist.gov/vuln/detail/CVE-2015-5300">CVE-2015-5300</a></td>
	</tr>
	<tr>
		<th><b>Affects</b></th>
		<td>All ntp-4 releases up to, but not including 4.2.8p5,<br> and 4.3.0 up to, but not including 4.3.78.</td>
		<td>Resolved in 4.2.8p5.</td>
	</tr>
	<tr>
		<th><b>CVSS2 Score</b></th>
		<td>MED 4.0</td>
		<td><a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:C/C:L/I:N/A:L">AV:N/AC:H/PR:H/UI:R/S:C/C:L/I:N/A:L</a></td>
	</tr>	
  </tbody>	
</table>
<hr>
<h4 id="description">Description</h4>
<p>If <code>ntpd</code> is always started with the <code>-g</code> option, which is common and against long-standing recommendation, and if at the moment <code>ntpd</code> is restarted an attacker can immediately respond to enough requests from enough sources trusted by the target, which is difficult and not common, there is a window of opportunity where the attacker can cause <code>ntpd</code> to set the time to an arbitrary value. Similarly, if an attacker is able to respond to enough requests from enough sources trusted by the target, the attacker can cause <code>ntpd</code> to abort and restart, at which point it can tell the target to set the time to an arbitrary value if and only if <code>ntpd</code> was re-started against long-standing recommendation with the <code>-g</code> flag, or if <code>ntpd</code> was not given the <code>-g</code> flag, the attacker can move the target system&rsquo;s time by at most 900 seconds' time per attack.</p>
<hr>
<h4 id="mitigation">Mitigation</h4>
<ul>
<li>Configure <code>ntpd</code> to get time from multiple sources.</li>
<li>Upgrade to <a href="/downloads/">4.2.8p5 or later.</a></li>
<li>As we&rsquo;ve long documented, only use the <code>-g</code> option to <code>ntpd</code> in cold-start situations.</li>
<li>Monitor your <code>ntpd</code> instances.</li>
</ul>
<hr>
<h4 id="credit">Credit</h4>
<p>This weakness was discovered by Aanchal Malhotra, Isaac E. Cohen, and Sharon Goldberg at Boston University.</p>
<hr>
<h4 id="timeline">Timeline</h4>
<ul>
<li>2016 Jan 7: Public release</li>
<li>2016 Jan 4: <a href="https://www.nwtime.org/membership/benefits/">Early Access Program Release: Premier and Partner Institutional Members</a></li>
<li>2015 Oct 16: <a href="https://www.nwtime.org/membership/benefits/">Notification to Institutional Members</a></li>
<li>2016 Oct 8: Initial notification; analysis begins</li>
</ul>

	  
  </div>
</section>
<nav class="site-footer navbar navbar-expand-sm mt-auto">
  <div class="container">
      <ul class="navbar-nav">
        
        <li class="nav-item" title="Twitter" aria-label="Twitter">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ntp">
          <img src="/images/icons/twitter.svg" width="20" height="20"></img>
          </a>
       </li>
       
        <li class="nav-item" title="LinkedIn" aria-label="LinkedIn">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/groups/4651343">
          <img src="/images/icons/linkedin.svg" width="20" height="20"></img>
          </a>
       </li>
       
        <li class="nav-item" title="Facebook" aria-label="Facebook">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/networktimeprotocol">
          <img src="/images/icons/facebook.svg" width="20" height="20"></img>
          </a>
       </li>
       
	  </ul>
	  <ul class="mx-auto pt-3">
        <p>&copy; 2022 <a class="navbar-text text-white" href="https://www.nwtime.org/">Network Time Foundation</a></p>	
      </ul>
    </div>
</nav>
</body>
</html>