<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="UTF-8">
  <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW"><link rel="canonical" href="https://test.doc.ntp.org/support/securitynotice/ntpbug2920/" />
  
  <meta property="og:title" content="NTP BUG 2920: Invalid length data provided by a custom refclock driver could cause a buffer overflow" />
<meta property="og:description" content="Summary Resolved4.2.8p421 Oct 2015ReferencesBug 2920CVE-2015-7853AffectsPotentially all ntp-4 releases running up to, but not including 4.2.8p4,
and 4.3.0 up to, but not including 4.3.77 that have custom refclocks.Resolved in 4.2.8p4.CVSS2 Score0.0 usual case, 5.9 unusual worst caseAV:L/AC:H/Au:M/C:C/I:C/A:C		 Description A negative value for the datalen parameter will overflow a data buffer." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://test.doc.ntp.org/support/securitynotice/ntpbug2920/" /><meta property="og:image" content="https://test.doc.ntp.org/images/sundial.jpg"/><meta property="article:section" content="support" />
<meta property="article:published_time" content="2015-10-21T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-03-02T17:28:34&#43;00:00" /><meta property="og:site_name" content="NTP: Network Time Protocol" />







  
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700,800,800i,900i&display=swap" rel="stylesheet"/>
   
  <title>NTP BUG 2920: Invalid length data provided by a custom refclock driver could cause a buffer overflow</title>

  <!-- Mobile Responsive Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="The NTP Project conducts Research and Development in NTP, a protocol designed to synchronize the clocks of computers over a network to a common timebase.">
  
  <meta name="generator" content="Hugo 0.83.1" />

  <!-- Plugins -->
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://test.doc.ntp.org/scss/nwtime.min.628523c03b8d13d316307f90d6bec3f6.css" media="screen">

  <!-- Favicon -->
  <link rel="shortcut icon" href="https://test.doc.ntp.org/favicons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="https://test.doc.ntp.org/favicons/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" type="image/png" href="https://test.doc.ntp.org/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="https://test.doc.ntp.org/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://test.doc.ntp.org/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="https://test.doc.ntp.org/favicons/android-chrome-512x512.png" sizes="512x512"></head>
<body><!-- navigation -->

<nav class="navbar navbar-expand-lg navbar-light">
  <div class="container-fluid">


	<div>
	  <a class="navbar-brand" href="https://www.nwtime.org"><img height="80" width="80" src="https://test.doc.ntp.org/images/logo.png" alt=""></a>
	  <a class="navbar-brand" href="https://test.doc.ntp.org/"><img height="80" width="80" src="https://test.doc.ntp.org/images/ntp_logo.jpg" alt="NTP: Network Time Protocol"></a> 
    </div>


    <div>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://test.doc.ntp.org/support/">Support</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://test.doc.ntp.org/reflib/">Reference Library</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://test.doc.ntp.org/documentation/">Documentation</a>
        </button>
      
    </div>



</nav>


  <div class="header-border">
  </div>
<!-- /navigation --><nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="https://test.doc.ntp.org/support/">Support</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://test.doc.ntp.org/support/securitynotice/">Security</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://test.doc.ntp.org/support/securitynotice/ntpbug2920/">NTP BUG 2920: Invalid length data provided by a custom refclock driver could cause a buffer overflow</a>
</li>

	</ol>
</nav	>


<section class="section pt-0  pb-auto">
  <div class="container">
  	<h1>NTP BUG 2920: Invalid length data provided by a custom refclock driver could cause a buffer overflow</h1>
     
    <p style="font-size: small; color: grey;">Last update: March 2, 2022 17:28 UTC (<a href="https://bitbucket.nwtime.org/projects/WEBSITES/repos/ntpwww/commits/616623bea5416e7a0cbd7f264448e7c01ba1f5e4">616623bea</a>)</p>
	<hr>
<h4 id="summary">Summary</h4>
<table>
  <tbody>
	<tr>
		<th><b>Resolved</b></th>
		<td><a href="https://test.doc.ntp.org/support/securitynotice/4_2_8p4-release-announcement/">4.2.8p4</a></td>
		<td>21 Oct 2015</td>
	</tr>
	<tr>
		<th><b>References</b></th>
		<td><a href="https://bugs.ntp.org/show_bug.cgi?id=2920">Bug 2920</a></td>
		<td><a href="https://nvd.nist.gov/vuln/detail/CVE-2015-7853">CVE-2015-7853</a></td>
	</tr>
	<tr>
		<th><b>Affects</b></th>
		<td>Potentially all ntp-4 releases running up to, but not including 4.2.8p4,<br> and 4.3.0 up to, but not including 4.3.77 that have custom refclocks.</td>
		<td>Resolved in 4.2.8p4.</td>
	</tr>
	<tr>
		<th><b>CVSS2 Score</b></th>
		<td>0.0 usual case, 5.9 unusual worst case</td>
		<td><a href="https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?calculator&version=2.0&vector=(AV:L/AC:H/Au:M/C:C/I:C/A:C)">AV:L/AC:H/Au:M/C:C/I:C/A:C</a></td>
	</tr>	
  </tbody>	
</table>
<hr>
<h4 id="description">Description</h4>
<p>A negative value for the <code>datalen</code> parameter will overflow a data buffer. NTF&rsquo;s <code>ntpd</code> driver implementations always set this value to 0 and are therefore not vulnerable to this weakness. If you are running a custom refclock driver in <code>ntpd</code> and that driver supplies a negative value for <code>datalen</code> (no custom driver of even minimal competence would do this) then <code>ntpd</code> would overflow a data buffer. It is even hypothetically possible in this case that instead of simply crashing <code>ntpd</code> the attacker could effect a code injection attack.</p>
<hr>
<h4 id="mitigation">Mitigation</h4>
<ul>
<li>Upgrade to <a href="https://test.doc.ntp.org/downloads/">4.2.8p4 or later</a>.</li>
<li>If you are unable to upgrade:
<ul>
<li>If you are running custom refclock drivers, make sure the signed <code>datalen</code> value is either zero or positive.</li>
</ul>
</li>
<li>Monitor your <code>ntpd</code> instances.</li>
</ul>
<hr>
<h4 id="credit">Credit</h4>
<p>This weakness was discovered by Yves Younan of Cisco Talos.</p>
<hr>
<h4 id="timeline">Timeline</h4>
<ul>
<li>2015 Oct 21: Public release</li>
<li>2015 Oct 6: <a href="https://www.nwtime.org/membership/benefits/">Early Access Program Release: Premier and Partner Institutional Members</a></li>
<li>2015 Aug 26: <a href="https://www.nwtime.org/membership/benefits/">Notification to Institutional Members</a> for <a href="https://test.doc.ntp.org/support/securitynotice/ntpbug1593/">1593</a>, <a href="https://test.doc.ntp.org/support/securitynotice/ntpbug1774/">1774</a>, <a href="https://test.doc.ntp.org/support/securitynotice/ntpbug2382/">2382</a>, <a href="https://test.doc.ntp.org/support/securitynotice/ntpbug2899/">2899</a>, and <a href="https://test.doc.ntp.org/support/securitynotice/ntpbug2902/">2902</a></li>
<li>2015 Aug 20: Initial notification of <a href="https://test.doc.ntp.org/support/securitynotice/ntpbug2902/">2902</a>; analysis begins</li>
<li>2015 Aug 11: Initial notification of <a href="https://test.doc.ntp.org/support/securitynotice/ntpbug2899/">2899</a>; analysis begins</li>
</ul>

	  
  </div>
</section>
<nav class="site-footer navbar navbar-expand-sm mt-auto">
  <div class="container">
      <ul class="navbar-nav">
        
        <li class="nav-item" title="Twitter" aria-label="Twitter">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ntp">
          <img src="https://test.doc.ntp.org/images/icons/twitter.svg" width="20" height="20"></img>
          </a>
       </li>
       
        <li class="nav-item" title="LinkedIn" aria-label="LinkedIn">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/groups/4651343">
          <img src="https://test.doc.ntp.org/images/icons/linkedin.svg" width="20" height="20"></img>
          </a>
       </li>
       
        <li class="nav-item" title="Facebook" aria-label="Facebook">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/networktimeprotocol">
          <img src="https://test.doc.ntp.org/images/icons/facebook.svg" width="20" height="20"></img>
          </a>
       </li>
       
	  </ul>
	  <ul class="mx-auto pt-3">
        <p>&copy; 2022 <a class="navbar-text text-white" href="https://www.nwtime.org/">Network Time Foundation</a></p>	
      </ul>
    </div>
</nav>
</body>
</html>