<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="UTF-8">
  <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW"><link rel="canonical" href="https://www.ntp.org/support/securitynotice/ntpbug3453/" />
  
  <meta property="og:title" content="NTP BUG 3453: Interleaved symmetric mode cannot recover from bad state" />
<meta property="og:description" content="A third-party can inject a packet with a zero-origin timestamp, meaning the sender wants to reset the association, and the transmit timestamp in this bogus packet will be saved as the most recent received timestamp. This bug was resolved in NTP 4.2.8p11." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.ntp.org/support/securitynotice/ntpbug3453/" /><meta property="og:image" content="https://www.ntp.org/images/NTPLogo800x418.webp"/><meta property="article:section" content="support" />
<meta property="article:published_time" content="2018-02-27T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-06-27T20:45:29&#43;01:00" /><meta property="og:site_name" content="NTP: Network Time Protocol" />


<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.ntp.org/images/NTPLogo800x418.webp"/>

<meta name="twitter:title" content="NTP BUG 3453: Interleaved symmetric mode cannot recover from bad state"/>
<meta name="twitter:description" content="A third-party can inject a packet with a zero-origin timestamp, meaning the sender wants to reset the association, and the transmit timestamp in this bogus packet will be saved as the most recent received timestamp. This bug was resolved in NTP 4.2.8p11."/>




<script async src="https://www.googletagmanager.com/gtag/js?id=G-K07ZJQFYSZ"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-K07ZJQFYSZ', { 'anonymize_ip': true });
</script>





<script>
window.onload = demo;
function demo() {
    document.getElementById("gsc-i-id1").setAttribute("placeholder", "Search...")
}
</script>


<script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "c33igkoodm");
</script>


  
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700,800,800i,900i&display=swap" rel="stylesheet"/>
   
  <title>NTP BUG 3453: Interleaved symmetric mode cannot recover from bad state</title>

  <!-- Mobile Responsive Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="A third-party can inject a packet with a zero-origin timestamp, meaning the sender wants to reset the association, and the transmit timestamp in this bogus packet will be saved as the most recent received timestamp. This bug was resolved in NTP 4.2.8p11.">
  
  <meta name="generator" content="Hugo 0.83.1" />

  <!-- Plugins -->
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://www.ntp.org/scss/nwtime.min.e9ca9b60a754990f6372651dffda1018.css" media="screen">

  <!-- Favicon -->
  <link rel="shortcut icon" href="https://www.ntp.org/favicons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="https://www.ntp.org/favicons/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" type="image/png" href="https://www.ntp.org/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="https://www.ntp.org/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://www.ntp.org/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="https://www.ntp.org/favicons/android-chrome-512x512.png" sizes="512x512"></head>
<body><!-- navigation -->

<nav class="navbar navbar-expand-lg navbar-light">
  <div class="container-fluid">


	<div>
	  <a class="navbar-brand" href="https://www.nwtime.org"><img height="80" width="80" src="https://www.ntp.org/images/logo.png" alt=""></a>
	  <a class="navbar-brand" href="https://www.ntp.org/"><img height="80" width="80" src="https://www.ntp.org/images/ntp_logo.jpg" alt="NTP: Network Time Protocol"></a> 
    </div>


    <div>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://www.ntp.org/support/">Support</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://www.ntp.org/reflib/">Reference Library</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://www.ntp.org/current-stable/">Documentation</a>
        </button>
      
	
	  <button class="btn btn-primary btn-lg" type="button"><a class="nav-item btn btn-primary btn-lg" style="text-decoration: none; text-transform: uppercase" href="https://www.ntp.org/donate/">Support NTP<br>Donate Today!</a>
      </button>
    </div>



<script async src="https://cse.google.com/cse.js?cx=bb3c9b3e375d856be"></script>
  <div class="gcse-search">
  </div>

</nav>


  <div class="header-border">
  </div>
<!-- /navigation --><nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="https://www.ntp.org/support/">Support</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://www.ntp.org/support/securitynotice/">Security</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://www.ntp.org/support/securitynotice/ntpbug3453/">NTP BUG 3453: Interleaved symmetric mode cannot recover from bad state</a>
</li>

	</ol>
</nav	>


<section class="section pt-0  pb-auto">
  <div class="container">
  	<h1>NTP BUG 3453: Interleaved symmetric mode cannot recover from bad state</h1> 
    <p style="font-size: small; color: grey;">Last update: June 27, 2022 20:45 UTC (<a href="https://git.nwtime.org/websites/ntpwww/commit/51d68a4aa2e1e83353ea0d34c3d4604c4d95f1e2">51d68a4aa</a>)</p>
	<hr>
<h4 id="summary">Summary</h4>
<table>
  <tbody>
	<tr>
		<th><b>Resolved</b></th>
		<td><a href="https://www.ntp.org/support/securitynotice/4_2_8p11-release-announcement/">4.2.8p11</a></td>
		<td>27 Feb 2018</td>
	</tr>
	<tr>
		<th><b>References</b></th>
		<td><a href="https://bugs.ntp.org/show_bug.cgi?id=3453">Bug 3453</a></td>
		<td><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-7184">CVE-2018-7184</a></td>
	</tr>
	<tr>
		<th><b>Affects</b></th>
		<td><code>ntpd</code> in ntp-4.2.8p4, up to but not including ntp-4.2.8p11.</td>
		<td>Resolved in 4.2.8p11.</td>
	</tr>
	<tr>
		<th><b>CVSS2 Score</b></th>
		<td>MED 4.3</td>
		<td><a href="https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?vector=(AV:N/AC:M/Au:N/C:P/I:N/A:N)">AV:N/AC:M/Au:N/C:P/I:N/A:N</a><br> Could score between 2.9 and 6.8.</td>
	</tr>
	<tr>
		<th><b>CVSS3 Score<b></th>
		<td>LOW 3.1</td>
		<td><a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L">CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L</a><br> Could score between 2.6 and 6.0.</td>
	</tr>	
  </tbody>	
</table>
<hr>
<h4 id="description">Description</h4>
<p>The fix for <a href="https://www.ntp.org/support/securitynotice/ntpbug2952/">NTP Bug 2952</a> was incomplete, and while it fixed one problem it created another. Specifically, it drops bad packets before updating the &ldquo;received&rdquo; timestamp. This means a third-party can inject a packet with a zero-origin timestamp, meaning the sender wants to reset the association, and the transmit timestamp in this bogus packet will be saved as the most recent &ldquo;received&rdquo; timestamp. The real remote peer does not know this value and this will disrupt the association until the association resets.</p>
<hr>
<h4 id="mitigation">Mitigation</h4>
<ul>
<li>Implement <a href="http://www.bcp38.info/index.php/Main_Page">BCP-38</a>.</li>
<li>Upgrade to <a href="https://www.ntp.org/downloads/">4.2.8p11 or later</a>.</li>
<li>Use authentication with peer mode.</li>
<li>Have enough sources of time.</li>
<li>Properly monitor your <code>ntpd</code> instances.</li>
<li>If <code>ntpd</code> stops running, auto-restart it without <code>-g</code>.</li>
</ul>
<hr>
<h4 id="credit">Credit</h4>
<p>This weakness was discovered by Miroslav Lichvar of Red Hat.</p>
<hr>
<h4 id="timeline">Timeline</h4>
<ul>
<li>2018 Feb 27: Public release</li>
<li>2018 Feb 12: <a href="https://www.nwtime.org/membership/benefits/">Early Access Program Release: Premier and Partner Institutional Members</a></li>
<li>2018 Jan 23: <a href="https://www.nwtime.org/membership/benefits/">Notification to Institutional Members</a></li>
<li>: Notification from reporter</li>
</ul>

	  
  </div>
</section>
<nav class="site-footer navbar navbar-expand-sm mt-auto">
  <div class="container">
      <ul class="navbar-nav">
        
        <li class="nav-item" title="LinkedIn" aria-label="LinkedIn">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/groups/4651343">
          <img src="https://www.ntp.org/images/icons/linkedin.svg" width="20" height="20"></img>
          </a>
       </li>
       
        <li class="nav-item" title="Facebook" aria-label="Facebook">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/networktimeprotocol">
          <img src="https://www.ntp.org/images/icons/facebook.svg" width="20" height="20"></img>
          </a>
       </li>
       
	  </ul>
	  <ul class="mx-auto pt-3">
        <p>&copy; 2024 <a class="navbar-text text-white" href="https://www.nwtime.org/">Network Time Foundation</a></p>	
      </ul>
    </div>
</nav>
</body>
</html>