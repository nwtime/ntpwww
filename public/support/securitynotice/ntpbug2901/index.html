<!doctype html><html lang=en><head><meta charset=utf-8><meta name=ROBOTS content="INDEX, FOLLOW"><meta name=description content="
Summary

  
	
		Resolved
		4.2.8p4
		21 Oct 2015
	
	
		References
		Bug 2901
		CVE-2015-7704 CVE-2015-7705
	
	
		Affects
		All ntp-4 â€¦"><meta property="og:title" content="NTP BUG 2901: Clients that receive a KoD should validate the origin timestamp field"><meta property="og:description" content="Summary Resolved4.2.8p421 Oct 2015ReferencesBug 2901CVE-2015-7704
CVE-2015-7705AffectsAll ntp-4 releases up to, but not including 4.2.8p4,
and 4.3.0 up to, but not including 4.3.77.Resolved in 4.2.8p4.CVSS2 Score4.3-5.0 at worstAV:N/AC:M/Au:N/C:N/I:N/A:P		 Description An ntpd client that honors Kiss-of-Death responses will honor KoD messages that have been forged by an attacker, causing it to delay or stop querying its servers for time updates."><meta property="og:type" content="article"><meta property="og:url" content="https://test.doc.ntp.org/support/securitynotice/ntpbug2901/"><meta property="article:section" content="support"><meta property="article:published_time" content="2015-10-21T00:00:00+00:00"><meta property="article:modified_time" content="2015-10-21T00:00:00+00:00"><meta property="og:site_name" content="NTP: Network Time Protocol"><title>NTP BUG 2901: Clients that receive a KoD should validate the origin timestamp field</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=generator content="Hugo 0.83.1"><link rel=stylesheet href=https://necolas.github.io/normalize.css/latest/normalize.css><link rel=stylesheet href=https://test.doc.ntp.org/plugins/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://test.doc.ntp.org/scss/nwtime.min.css media=screen><link rel="shortcut icon" href=https://test.doc.ntp.org/favicons/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=https://test.doc.ntp.org/favicons/apple-touch-icon.png sizes=180x180><link rel=icon type=image/png href=https://test.doc.ntp.org/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=https://test.doc.ntp.org/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://test.doc.ntp.org/favicons/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=https://test.doc.ntp.org/favicons/android-chrome-512x512.png sizes=512x512></head><body><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css><header class="sticky-top navigation"><div class=container><nav class="navbar navbar-expand-lg navbar-light py-0"><div class="d-flex align-items-center" style=height:80px;width:80px><a class="py-0 mx-1" href=https://www.nwtime.org><img class=img-fluid src=https://test.doc.ntp.org/images/logo.png alt></a></div><div class="d-flex align-items-center" style=height:80px;width:80px><a class="navbar-brand py-0 mx-1" href=https://test.doc.ntp.org/><img class=img-fluid src=https://test.doc.ntp.org/images/ntp_logo.jpg alt="NTP: Network Time Protocol"></a></div><button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class=bi-plus></i></button><div class="collapse navbar-collapse text-center" id=navigation><ul class="navbar-nav ml-auto py-0"><li class="nav-item py-0"><a class="nav-link py-0" style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/></a></li><li class="nav-item dropdown py-0"><a class="nav-link dropdown-toggle py-0" style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Support</a><div class=dropdown-menu><a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://support.ntp.org/>Support Wiki</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://support.ntp.org/bin/view/Servers/WebHome>Time Servers</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/support/securitynotice>Security</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/ntpfaq>FAQ</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://support.ntp.org/bin/view/Dev/WebHome>Developer Resources</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/contributorslist>Contributors List</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/contact>Contacts</a></div></li><li class="nav-item dropdown py-0"><a class="nav-link dropdown-toggle py-0" style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Reference Library</a><div class=dropdown-menu><a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/reflib/brief>Briefs</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/reflib/memos>Memos</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/reflib/reports>Reports</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/reflib/rfc>RFCs</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/reflib/software>Software</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/reflib/papers>White Papers</a></div></li><li class="nav-item dropdown py-0"><a class="nav-link dropdown-toggle py-0" style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Documentation</a><div class=dropdown-menu><a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/archives/4.2.8-series>4.2.8-series</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/archives/4.2.6-series>4.2.6-series</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/archives/4.2.4-series>4.2.4-series</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/archives/4.2.2-series>4.2.2-series</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/archives/4.2.0>4.2.0</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/archives/4.1.2>4.1.2</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/archives/4.1.1>4.1.1</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/archives/4.1.0>4.1.0</a>
<a class=dropdown-item style="text-decoration:none;font-size:16px;font-family:nunito sans,sans-serif" href=https://test.doc.ntp.org/archives/3-5.93e>3-5.93e</a></div></li></ul></div><script async src="https://cse.google.com/cse.js?cx=bb3c9b3e375d856be"></script><div class=gcse-search></div></nav></div><div class=header-border></div></header><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://test.doc.ntp.org/support/>Support</a></li><li class=breadcrumb-item><a href=https://test.doc.ntp.org/support/securitynotice/>Security</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://test.doc.ntp.org/support/securitynotice/ntpbug2901/>NTP BUG 2901: Clients that receive a KoD should validate the origin timestamp field</a></li></ol></nav><section class="section pt-0 pb-auto"><div class=container><h1>NTP BUG 2901: Clients that receive a KoD should validate the origin timestamp field</h1><hr><h4 id=summary>Summary</h4><table><tbody><tr><th><b>Resolved</b></th><td><a href=/support/securitynotice/4_2_8p4-release-announcement/>4.2.8p4</a></td><td>21 Oct 2015</td></tr><tr><th><b>References</b></th><td><a href="https://bugs.ntp.org/show_bug.cgi?id=2901">Bug 2901</a></td><td><a href=https://nvd.nist.gov/vuln/detail/CVE-2015-7704>CVE-2015-7704</a><br><a href=https://nvd.nist.gov/vuln/detail/CVE-2015-7705>CVE-2015-7705</a></td></tr><tr><th><b>Affects</b></th><td>All ntp-4 releases up to, but not including 4.2.8p4,<br>and 4.3.0 up to, but not including 4.3.77.</td><td>Resolved in 4.2.8p4.</td></tr><tr><th><b>CVSS2 Score</b></th><td>4.3-5.0 at worst</td><td><a href="https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?calculator&version=2.0&vector=(AV:N/AC:M/Au:N/C:N/I:N/A:P)">AV:N/AC:M/Au:N/C:N/I:N/A:P</a></td></tr></tbody></table><hr><h4 id=description>Description</h4><p>An <code>ntpd</code> client that honors Kiss-of-Death responses will honor KoD messages that have been forged by an attacker, causing it to delay or stop querying its servers for time updates. Also, an attacker can forge packets that claim to be from the target and send them to servers often enough that a server that implements KoD rate limiting will send the target machine a KoD response to attempt to reduce the rate of incoming packets, or it may also trigger a firewall block at the server for packets from the target machine. For either of these attacks to succeed, the attacker must know what servers the target is communicating with. An attacker can be anywhere on the Internet and can frequently learn the identity of the target&rsquo;s time source by sending the target a time query.</p><hr><h4 id=mitigation>Mitigation</h4><ul><li>Implement <a href=http://www.bcp38.info/index.php/Main_Page>BCP-38.</a></li><li>Upgrade to <a href=/downloads/>4.2.8p4 or later</a>.</li><li>If you cannot upgrade, restrict who can query <code>ntpd</code> to learn who its servers are, and what IPs are allowed to ask your system for the time. This mitigation is heavy-handed.</li><li>Monitor your <code>ntpd</code> instances.</li></ul><blockquote><p><strong>NOTE:</strong> 4.2.8p4 protects against the first attack. For the second attack, all we can do is warn when it is happening, which we do in 4.2.8p4.</p></blockquote><hr><h4 id=credit>Credit</h4><p>This weakness was discovered by Aanchal Malhotra, Issac E. Cohen, and Sharon Goldberg of Boston University.</p><hr><h4 id=timeline>Timeline</h4><ul><li>2015 Oct 21: Public release</li><li>2015 Oct 6: <a href=https://www.nwtime.org/membership/benefits/>Early Access Program Release: Premier and Partner Institutional Members</a></li><li>2015 Aug 26: <a href=https://www.nwtime.org/membership/benefits/>Notification to Institutional Members</a> for <a href=/support/securitynotice/ntpbug1593/>1593</a>, <a href=/support/securitynotice/ntpbug1774/>1774</a>, <a href=/support/securitynotice/ntpbug2382/>2382</a>, <a href=/support/securitynotice/ntpbug2899/>2899</a>, and <a href=/support/securitynotice/ntpbug2902/>2902</a></li><li>2015 Aug 20: Initial notification of <a href=/support/securitynotice/ntpbug2902/>2902</a>; analysis begins</li><li>2015 Aug 11: Initial notification of <a href=/support/securitynotice/ntpbug2899/>2899</a>; analysis begins</li></ul></div></section><footer class="navbar site-footer fixed-bottom py-0"><ul class=mx-auto><li class=navbar-text data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel="noopener noreferrer" href=https://twitter.com/ntp><i class=bi-twitter></i></a></li><li class=navbar-text data-toggle=tooltip data-placement=top title=LinkedIn aria-label=LinkedIn><a class=text-white target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/groups/4651343><i class=bi-linkedin></i></a></li><li class=navbar-text data-toggle=tooltip data-placement=top title=Facebook aria-label=Facebook><a class=text-white target=_blank rel="noopener noreferrer" href=https://www.facebook.com/networktimeprotocol><i class=bi-facebook></i></a></li><li class=navbar-text><p>&copy; 2022 <a class="navbar-text text-white" href=https://www.nwtime.org>Network Time Foundation</a></p></li></ul></footer></body></html>