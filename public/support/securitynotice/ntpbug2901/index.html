<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="UTF-8">
  <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW"><link rel="canonical" href="https://www.ntp.org/support/securitynotice/ntpbug2901/" />
  
  <meta property="og:title" content="NTP BUG 2901: Clients that receive a KoD should validate the origin timestamp field" />
<meta property="og:description" content="An ntpd client that honors Kiss-of-Death responses will honor KoD messages that have been forged by an attacker, causing it to delay or stop querying its servers for time updates. This bug was resolved in NTP 4.2.8p4." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.ntp.org/support/securitynotice/ntpbug2901/" /><meta property="og:image" content="https://www.ntp.org/images/NTPLogo800x418.webp"/><meta property="article:section" content="support" />
<meta property="article:published_time" content="2015-10-21T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2024-04-22T18:49:16&#43;01:00" /><meta property="og:site_name" content="NTP: Network Time Protocol" />


<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.ntp.org/images/NTPLogo800x418.webp"/>

<meta name="twitter:title" content="NTP BUG 2901: Clients that receive a KoD should validate the origin timestamp field"/>
<meta name="twitter:description" content="An ntpd client that honors Kiss-of-Death responses will honor KoD messages that have been forged by an attacker, causing it to delay or stop querying its servers for time updates. This bug was resolved in NTP 4.2.8p4."/>




<script async src="https://www.googletagmanager.com/gtag/js?id=G-K07ZJQFYSZ"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-K07ZJQFYSZ', { 'anonymize_ip': true });
</script>





<script>
window.onload = demo;
function demo() {
    document.getElementById("gsc-i-id1").setAttribute("placeholder", "Search...")
}
</script>


<script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "c33igkoodm");
</script>


  
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700,800,800i,900i&display=swap" rel="stylesheet"/>
   
  <title>NTP BUG 2901: Clients that receive a KoD should validate the origin timestamp field</title>

  <!-- Mobile Responsive Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="An ntpd client that honors Kiss-of-Death responses will honor KoD messages that have been forged by an attacker, causing it to delay or stop querying its servers for time updates. This bug was resolved in NTP 4.2.8p4.">
  
  <meta name="generator" content="Hugo 0.83.1" />

  <!-- Plugins -->
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://www.ntp.org/scss/nwtime.min.88a7f853c9f0350ac0942eda114d25cc.css" media="screen">

  <!-- Favicon -->
  <link rel="shortcut icon" href="https://www.ntp.org/favicons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="https://www.ntp.org/favicons/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" type="image/png" href="https://www.ntp.org/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="https://www.ntp.org/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://www.ntp.org/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="https://www.ntp.org/favicons/android-chrome-512x512.png" sizes="512x512"></head>
<body><!-- navigation -->

<nav class="navbar navbar-expand-lg navbar-light">
  <div class="container-fluid">


	<div>
	  <a class="navbar-brand" href="https://www.nwtime.org"><img height="80" width="80" src="https://www.ntp.org/images/logo.png" alt=""></a>
	  <a class="navbar-brand" href="https://www.ntp.org/"><img height="80" width="80" src="https://www.ntp.org/images/ntp_logo.jpg" alt="NTP: Network Time Protocol"></a> 
    </div>


    <div>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://www.ntp.org/support/">Support</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://www.ntp.org/reflib/">Reference Library</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://www.ntp.org/current-stable/">Documentation</a>
        </button>
      
	
	  <button class="btn btn-primary btn-lg" type="button"><a class="nav-item btn btn-primary btn-lg" style="text-decoration: none; text-transform: uppercase" href="https://www.ntp.org/donate/">Support NTP<br>Donate Today!</a>
      </button>
    </div>



<script async src="https://cse.google.com/cse.js?cx=bb3c9b3e375d856be"></script>
  <div class="gcse-search">
  </div>

</nav>


  <div class="header-border">
  </div>
<!-- /navigation --><nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="https://www.ntp.org/support/">Support</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://www.ntp.org/support/securitynotice/">Security</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://www.ntp.org/support/securitynotice/ntpbug2901/">NTP BUG 2901: Clients that receive a KoD should validate the origin timestamp field</a>
</li>

	</ol>
</nav	>


<section class="section pt-0  pb-auto">
  <div class="container">
  	<h1>NTP BUG 2901: Clients that receive a KoD should validate the origin timestamp field</h1> 
    <p style="font-size: small; color: grey;">Last update: April 22, 2024 18:49 UTC (<a href="https://git.nwtime.org/websites/ntpwww/commit/7e7bd5857f893277639b3765bf9347c4c6faa447">7e7bd5857</a>)</p>
	<hr>
<h4 id="summary">Summary</h4>
<table>
  <tbody>
	<tr>
		<th><b>Resolved</b></th>
		<td><a href="https://www.ntp.org/support/securitynotice/4_2_8p4-release-announcement/">4.2.8p4</a></td>
		<td>21 Oct 2015</td>
	</tr>
	<tr>
		<th><b>References</b></th>
		<td><a href="https://bugs.ntp.org/show_bug.cgi?id=2901">Bug 2901</a></td>
		<td><a href="https://nvd.nist.gov/vuln/detail/CVE-2015-7704">CVE-2015-7704</a><br> <a href="https://nvd.nist.gov/vuln/detail/CVE-2015-7705">CVE-2015-7705</a></td>
	</tr>
	<tr>
		<th><b>Affects</b></th>
		<td>All ntp-4 releases up to, but not including 4.2.8p4,<br> and 4.3.0 up to, but not including 4.3.77.</td>
		<td>Resolved in 4.2.8p4.</td>
	</tr>
	<tr>
		<th><b>CVSS2 Score</b></th>
		<td>4.3-5.0 at worst</td>
		<td><a href="https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?calculator&version=2.0&vector=(AV:N/AC:M/Au:N/C:N/I:N/A:P)">AV:N/AC:M/Au:N/C:N/I:N/A:P</a></td>
	</tr>	
  </tbody>	
</table>
<hr>
<h4 id="description">Description</h4>
<p>An <code>ntpd</code> client that honors Kiss-of-Death responses will honor KoD messages that have been forged by an attacker, causing it to delay or stop querying its servers for time updates. Also, an attacker can forge packets that claim to be from the target and send them to servers often enough that a server that implements KoD rate limiting will send the target machine a KoD response to attempt to reduce the rate of incoming packets, or it may also trigger a firewall block at the server for packets from the target machine. For either of these attacks to succeed, the attacker must know what servers the target is communicating with. An attacker can be anywhere on the Internet and can frequently learn the identity of the target&rsquo;s time source by sending the target a time query.</p>
<hr>
<h4 id="mitigation">Mitigation</h4>
<ul>
<li>Implement <a href="http://www.bcp38.info/index.php/Main_Page">BCP-38.</a></li>
<li>Upgrade to <a href="https://downloads.nwtime.org/ntp/4.2.8/">4.2.8p4 or later</a>.</li>
<li>If you cannot upgrade, restrict who can query <code>ntpd</code> to learn who its servers are, and what IPs are allowed to ask your system for the time. This mitigation is heavy-handed.</li>
<li>Monitor your <code>ntpd</code> instances.</li>
</ul>
<blockquote>
<p><strong>NOTE:</strong> 4.2.8p4 protects against the first attack. For the second attack, all we can do is warn when it is happening, which we do in 4.2.8p4.</p>
</blockquote>
<hr>
<h4 id="credit">Credit</h4>
<p>This weakness was discovered by Aanchal Malhotra, Issac E. Cohen, and Sharon Goldberg of Boston University.</p>
<hr>
<h4 id="timeline">Timeline</h4>
<ul>
<li>2015 Oct 21: Public release</li>
<li>2015 Oct 6: <a href="https://www.nwtime.org/membership/benefits/">Early Access Program Release: Premier and Partner Institutional Members</a></li>
<li>2015 Aug 26: <a href="https://www.nwtime.org/membership/benefits/">Notification to Institutional Members</a> for <a href="https://www.ntp.org/support/securitynotice/ntpbug1593/">1593</a>, <a href="https://www.ntp.org/support/securitynotice/ntpbug1774/">1774</a>, <a href="https://www.ntp.org/support/securitynotice/ntpbug2382/">2382</a>, <a href="https://www.ntp.org/support/securitynotice/ntpbug2899/">2899</a>, and <a href="https://www.ntp.org/support/securitynotice/ntpbug2902/">2902</a></li>
<li>2015 Aug 20: Initial notification of <a href="https://www.ntp.org/support/securitynotice/ntpbug2902/">2902</a>; analysis begins</li>
<li>2015 Aug 11: Initial notification of <a href="https://www.ntp.org/support/securitynotice/ntpbug2899/">2899</a>; analysis begins</li>
</ul>

	  
  </div>
</section>
<nav class="site-footer navbar navbar-expand-sm mt-auto">
  <div class="container">
      <ul class="navbar-nav">
        
        <li class="nav-item" title="LinkedIn" aria-label="LinkedIn">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/groups/4651343">
          <img src="https://www.ntp.org/images/icons/linkedin.svg" width="20" height="20"></img>
          </a>
       </li>
       
        <li class="nav-item" title="Facebook" aria-label="Facebook">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/networktimeprotocol">
          <img src="https://www.ntp.org/images/icons/facebook.svg" width="20" height="20"></img>
          </a>
       </li>
       
	  </ul>
	  <ul class="mx-auto pt-3">
        <p>&copy; 2024 <a class="navbar-text text-white" href="https://www.nwtime.org/">Network Time Foundation</a></p>	
      </ul>
    </div>
</nav>
</body>
</html>