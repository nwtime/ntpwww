<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="UTF-8">
  <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
  
  

  
  <meta name="description" content="
Author: David L. Mills (mills@udel.edu)
Last change: 31-Mar-2014 07:46 UTC


Table of Contents

Synopsis
Description
Fudge Factors
Additional â€¦">
<meta property="og:title" content="PPS Clock Discipline" />
<meta property="og:description" content="Author: David L. Mills (mills@udel.edu) Last change: 31-Mar-2014 07:46 UTC   Table of Contents  Synopsis Description Fudge Factors Additional Information   Synopsis  Address: 127.127.22.u Reference ID: PPS Driver ID: PPS Serial or Parallel Port: /dev/ppsu Requires: PPSAPI signal interface for PPS signal processing.   NOTE: This driver supersedes an older one of the same name. The older driver operated with several somewhat archaic signal interface devices, required intricate configuration and was poorly documented." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://test.doc.ntp.org/archives/drivers/driver22/" /><meta property="article:section" content="archives" />

<meta property="og:site_name" content="NTP: Network Time Protocol" />



  
  <title>PPS Clock Discipline</title>

  <!-- Mobile Responsive Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  
  <meta name="generator" content="Hugo 0.83.1" />

  <!-- Plugins -->
  
    <link rel="stylesheet" href="https://necolas.github.io/normalize.css/latest/normalize.css">
  
    <link rel="stylesheet" href="https://test.doc.ntp.org/plugins/bootstrap/bootstrap.min.css">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://test.doc.ntp.org/scss/nwtime.min.css" media="screen">

  <!-- Favicon -->
  <link rel="shortcut icon" href="https://test.doc.ntp.org/favicons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="https://test.doc.ntp.org/favicons/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" type="image/png" href="https://test.doc.ntp.org/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="https://test.doc.ntp.org/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://test.doc.ntp.org/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="https://test.doc.ntp.org/favicons/android-chrome-512x512.png" sizes="512x512"></head>
<body><!-- navigation -->
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

<header class="sticky-top navigation">
  <div class="container">


    <nav class="navbar navbar-expand-lg navbar-light py-0">
	  <div class="d-flex align-items-center" style="height:80px; width:80px;">
		 <a class="py-0 mx-1" href="https://www.nwtime.org"><img class="img-fluid" src="https://test.doc.ntp.org/images/logo.png" alt=""></a>
      </div>
	  <div class="d-flex align-items-center" style="height:80px; width:80px;">
		 <a class="navbar-brand py-0 mx-1" href="https://test.doc.ntp.org/"><img class="img-fluid" src="https://test.doc.ntp.org/images/ntp_logo.jpg" alt="NTP: Network Time Protocol"></a> 
      </div>
	  <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="bi-plus"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <ul class="navbar-nav ml-auto py-0">
          <li class="nav-item py-0">
            <a class="nav-link py-0" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/"></a>
          </li>
          
          
          <li class="nav-item dropdown py-0">
            <a class="nav-link dropdown-toggle py-0" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Support
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://support.ntp.org/">Support Wiki</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/support/servers">Time Servers</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/support/securitynotice">Security</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/ntpfaq">FAQ</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://support.ntp.org/bin/view/Dev/WebHome">Developer Resources</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/contributorslist">Contributors List</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/contact">Contacts</a>
              
            </div>
          </li>
          
          
          
          <li class="nav-item dropdown py-0">
            <a class="nav-link dropdown-toggle py-0" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Reference Library
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/reflib/brief">Briefs</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/reflib/memos">Memos</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/reflib/reports">Reports</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/reflib/rfc">RFCs</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/reflib/software">Software</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/reflib/papers">White Papers</a>
              
            </div>
          </li>
          
          
          
          <li class="nav-item dropdown py-0">
            <a class="nav-link dropdown-toggle py-0" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Documentation
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/archives/4.2.8-series">4.2.8-series</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/archives/4.2.6-series">4.2.6-series</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/archives/4.2.4-series">4.2.4-series</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/archives/4.2.2-series">4.2.2-series</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/archives/4.2.0">4.2.0</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/archives/4.1.2">4.1.2</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/archives/4.1.1">4.1.1</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/archives/4.1.0">4.1.0</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://test.doc.ntp.org/archives/3-5.93e">3-5.93e</a>
              
            </div>
          </li>
          
          
        </ul>
      </div>
	  
      <script async src="https://cse.google.com/cse.js?cx=bb3c9b3e375d856be"></script>
      <div class="gcse-search">
      </div>

    </nav>
  </div>
  <div class="header-border">
  </div>
</header>
<!-- /navigation --><nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="https://test.doc.ntp.org/documentation/">Documentation</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://test.doc.ntp.org/archives/drivers/">Drivers</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://test.doc.ntp.org/archives/drivers/driver22/">PPS Clock Discipline</a>
</li>

	</ol>
</nav	>


<section class="section pt-0  pb-auto">
  <div class="container">
  	<h1>PPS Clock Discipline</h1>
     
    <dl>
<dt>Author: David L. Mills (<a href="mailto:mills@udel.edu">mills@udel.edu</a>)</dt>
<dd>Last change: 31-Mar-2014 07:46 UTC</dd>
</dl>
<hr>
<h4 id="table-of-contents">Table of Contents</h4>
<ul>
<li><a href="/archives/drivers/driver22/#synopsis">Synopsis</a></li>
<li><a href="/archives/drivers/driver22/#description">Description</a></li>
<li><a href="/archives/drivers/driver22/#fudge-factors">Fudge Factors</a></li>
<li><a href="/archives/drivers/driver22/#additional-information">Additional Information</a></li>
</ul>
<hr>
<h4 id="synopsis">Synopsis</h4>
<dl>
<dt><strong>Address:</strong> <code>127.127.22.<em>u</em></code></dt>
<dd><strong>Reference ID:</strong> <code>PPS</code></dd>
<dd><strong>Driver ID:</strong> <code>PPS</code></dd>
<dd><strong>Serial or Parallel Port:</strong> <code>/dev/pps<em>u</em></code></dd>
<dd><strong>Requires:</strong> PPSAPI signal interface for PPS signal processing.</dd>
</dl>
<blockquote>
<p><strong>NOTE:</strong> This driver supersedes an older one of the same name. The older driver operated with several somewhat archaic signal interface devices, required intricate configuration and was poorly documented. This driver requires the Pulse per Second API (PPSAPI)<sup><a href="#myfootnote1">1</a></sup>. Note also that the <code>pps</code> configuration command has been obsoleted by this driver.</p>
</blockquote>
<hr>
<h4 id="description">Description</h4>
<p>This driver furnishes an interface for the pulse-per-second (PPS) signal produced by a cesium clock, radio clock or related devices. It can be used to augment the serial timecode generated by a GPS receiver, for example. It can be used to remove accumulated jitter and re-time a secondary server when synchronized to a primary server over a congested, wide-area network and before redistributing the time to local clients. The driver includes extensive signal sanity checks and grooming algorithms. A range gate and frequency discriminator reject noise and signals with incorrect frequency. A multiple-stage median filter rejects jitter due to hardware interrupt and operating system latencies. A trimmed-mean algorithm determines the best time samples. With typical workstations and processing loads, the incidental jitter can be reduced to a few microseconds.</p>
<p>While this driver can discipline the time and frequency relative to the PPS source, it cannot number the seconds. For this purpose an auxiliary source is required, ordinarily a radio clock operated as a primary reference (stratum 1) source; however, another NTP time server can be used as well. For this purpose, the auxiliary source should be specified as the prefer peer, as described in the <a href="/archives/4.2.8-series/prefer/">Mitigation Rules and the <code>prefer</code> Keyword</a> page.</p>
<p>The driver requires the PPSAPI interface<sup><a href="#myfootnote1">1</a></sup>, which is a proposed IETF standard. The interface consists of the <code>timepps.h</code> header file and associated kernel support. Support for this interface is included in current versions of Solaris, FreeBSD and Linux and proprietary versions of Tru64 (Alpha) and SunOS. See the <a href="/archives/4.2.8-series/pps/">Pulse-per-second (PPS) Signal Interfacing</a> page for further information.</p>
<p>The PPS source can be connected via a serial or parallel port, depending on the hardware and operating system. A serial port can be dedicated to the PPS source or shared with another device; however, if dedicated the data leads should not be connected, as noise or unexpected signals can cause <code>ntpd</code> to exit.</p>
<p>A radio clock is usually connected via a serial port and the PPS source connected via a level converter to the data carrier detect (DCD) pin (DB-9 pin 1, DB-25 pin 8) of the same connector. In some systems where a parallel port and driver are available, the PPS signal can be connected directly to the ACK pin (DB25 pin 10) of the connector. Whether the PPS signal is connected via a dedicated port or shared with another device, the driver opens the device <code>/dev/pps%d</code>, where <code>%d</code> is the unit number. As with other drivers, links can be used to redirect the logical name to the actual physical device.</p>
<p>The driver normally operates like any other driver and uses the same mitigation algorithms and PLL/FLL clock discipline incorporated in the daemon. If kernel PLL/FLL support is available, the kernel PLL/FLL clock discipline can be used instead. The default behavior is not to use the kernel PPS clock discipline, even if present. This driver incorporates a good deal of signal processing to reduce jitter using the median filter algorithm in the driver. As the result, performance with <code>minpoll</code> configured at 4 (16s) is generally better than the kernel PPS discipline. However, fudge <code>flag 3</code> can be used to enable the kernel PPS discipline if necessary.</p>
<p>This driver is enabled only under one of two conditions: (a) a prefer peer other than this driver is among the survivors of the mitigation algorithms or (b) there are no survivors and the <code>minsane</code> option of the <code>tos</code> command is 0. The prefer peer designates another source that can reliably number the seconds when available . However, if no sources are available, the system clock continues to be disciplined by the PPS driver on an indefinite basis.</p>
<p>A scenario where the latter behavior can be most useful is a planetary orbiter fleet, for instance in the vicinity of Mars, where contact between orbiters and Earth occurs only one or two times per Sol (Mars day). These orbiters have a precise timing reference based on an Ultra Stable Oscillator (USO) with accuracy in the order of a Cesium oscillator. A PPS signal is derived from the USO and can be disciplined from Earth on rare occasion or from another orbiter via NTP. In the above scenario the PPS signal disciplines the spacecraft clock between NTP updates.</p>
<p>In a similar scenario a PPS signal can be used to discipline the clock between updates produced by the modem driver. This would provide precise synchronization without needing the Internet at all.</p>
<hr>
<h4 id="fudge-factors">Fudge Factors</h4>
<dl>
<dt><code><strong>time1 <em>time</em></strong></code></dt>
<dd>
<p>Specifies the time offset calibration factor, in seconds and fraction, with default 0.0.</p>
</dd>
<dt><code><strong>time2 <em>time</em></strong></code></dt>
<dd>
<p>Not used by this driver.</p>
</dd>
<dt><code><strong>stratum <em>number</em></strong></code></dt>
<dd>
<p>Specifies the driver stratum, in decimal from 0 to 15, with default 0.</p>
</dd>
<dt><code><strong>refid <em>string</em></strong></code></dt>
<dd>
<p>Specifies the driver reference identifier, an ASCII string from one to four characters, with default <code>PPS</code>.</p>
</dd>
<dt><code><strong>flag1 0 | 1</strong></code></dt>
<dd>
<p>Not used by this driver.</p>
</dd>
<dt><code><strong>flag2 0 | 1</strong></code></dt>
<dd>
<p>Specifies PPS capture on the rising (assert) pulse edge if 0 (default) or falling (clear) pulse edge if 1. Not used under Windows - if the special <code>serialpps.sys</code> serial port driver is installed then the leading edge will <em>always</em> be used.</p>
</dd>
<dt><code><strong>flag3 0 | 1</strong></code></dt>
<dd>
<p>Controls the kernel PPS discipline: 0 for disable (default), 1 for enable. Not used under Windows - if the special <code>serialpps.sys</code> serial port driver is used then kernel PPS will be available and used.</p>
</dd>
<dt><code><strong>flag4 0 | 1</strong></code></dt>
<dd>
<p>Record a timestamp once for each second if 1. Useful for constructing Allan deviation plots.</p>
</dd>
</dl>
<hr>
<h4 id="additional-information">Additional Information</h4>
<p><a href="/archives/4.2.8-series/refclock/">Reference Clock Drivers</a></p>
<p><a name="myfootnote1">1</a>  Mogul, J., D. Mills, J. Brittenson, J. Stone and U. Windl. Pulse-per-second API for Unix-like operating systems, version 1. Request for Comments <a href="/reflib/rfc/rfc2783.txt">RFC 2783</a>, Internet Engineering Task Force, March 2000, 31 pp.</p>

	  
  </div>
</section>
<footer class="navbar site-footer fixed-bottom py-0">
  <ul class="mx-auto">
    
    <li class="navbar-text" data-toggle="tooltip" data-placement="top" title="Mailing lists" aria-label="Mailing lists">
      <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://lists.ntp.org/listinfo">
        <i class="bi-envelope"></i>
      </a>
    </li>
    
    <li class="navbar-text" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
      <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ntp">
        <i class="bi-twitter"></i>
      </a>
    </li>
    
    <li class="navbar-text" data-toggle="tooltip" data-placement="top" title="LinkedIn" aria-label="LinkedIn">
      <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/groups/4651343">
        <i class="bi-linkedin"></i>
      </a>
    </li>
    
    <li class="navbar-text" data-toggle="tooltip" data-placement="top" title="Facebook" aria-label="Facebook">
      <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/networktimeprotocol">
        <i class="bi-facebook"></i>
      </a>
    </li>
    
    <li class="navbar-text">
      <p>&copy; 2022 <a class="navbar-text text-white" href="https://www.nwtime.org">Network Time Foundation</a></p>	
    </li>
  </ul>
</footer>

</body>
</html>