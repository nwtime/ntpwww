<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="UTF-8">
  <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
  
  

  
  <meta name="description" content="This version operates in much the same manner as Version 2 with the following changes and additions:


The protocol machinery operates in conformance â€¦">
<meta property="og:title" content="Notes for NTPv3" />
<meta property="og:description" content="This version operates in much the same manner as Version 2 with the following changes and additions:
  The protocol machinery operates in conformance with the RFC 1305 NTP Version 3 specification. The most visible characteristic of this version is that the poll intervals for all polls, even selected ones, is significantly increased. This is especially desirable when serving a large client population. This implementation supports previous versions as non-configured peers; for version-2 configured peers a version 2 keyword should be included on the peer line." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://doc.ntp.org/archives/hints/notes-xntp-v3/" /><meta property="article:section" content="archives" />

<meta property="og:site_name" content="NTP: Network Time Protocol" />



<script async src="https://www.googletagmanager.com/gtag/js?id=G-BN61ZTDHBP"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-BN61ZTDHBP', { 'anonymize_ip': false });
}
</script>

  
  <title>Notes for NTPv3</title>

  <!-- Mobile Responsive Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  
  <meta name="generator" content="Hugo 0.83.1" />

  <!-- Plugins -->
  
    <link rel="stylesheet" href="https://necolas.github.io/normalize.css/latest/normalize.css">
  
    <link rel="stylesheet" href="https://doc.ntp.org/plugins/bootstrap/bootstrap.min.css">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://doc.ntp.org/scss/nwtime.min.css" media="screen">

  <!-- Favicon -->
  <link rel="shortcut icon" href="https://doc.ntp.org/favicons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="https://doc.ntp.org/favicons/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/android-chrome-512x512.png" sizes="512x512"></head>
<body><!-- navigation -->
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

<header class="sticky-top navigation">
  <div class="container">


    <nav class="navbar navbar-expand-lg navbar-light py-0">
	  <div class="d-flex align-items-center" style="height:80px; width:80px;">
		 <a class="py-0 mx-1" href="https://www.nwtime.org"><img class="img-fluid" src="https://doc.ntp.org/images/logo.png" alt=""></a>
      </div>
	  <div class="d-flex align-items-center" style="height:80px; width:80px;">
		 <a class="navbar-brand py-0 mx-1" href="https://doc.ntp.org/"><img class="img-fluid" src="https://doc.ntp.org/images/ntp_logo.jpg" alt="NTP: Network Time Protocol"></a> 
      </div>
	  <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="bi-plus"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <ul class="navbar-nav ml-auto py-0">
          <li class="nav-item py-0">
            <a class="nav-link py-0" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/"></a>
          </li>
          
          
          <li class="nav-item dropdown py-0">
            <a class="nav-link dropdown-toggle py-0" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Support
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://support.ntp.org/">Support Wiki</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://support.ntp.org/bin/view/Servers/WebHome">Time Servers</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/support/securitynotice">Security</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/ntpfaq">FAQ</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://support.ntp.org/bin/view/Dev/WebHome">Developer Resources</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/contributorslist">Contributors List</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/contact">Contacts</a>
              
            </div>
          </li>
          
          
          
          <li class="nav-item dropdown py-0">
            <a class="nav-link dropdown-toggle py-0" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Reference Library
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/reflib/brief">Briefs</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/reflib/memos">Memos</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/reflib/reports">Reports</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/reflib/rfc">RFCs</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/reflib/software">Software</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/reflib/papers">White Papers</a>
              
            </div>
          </li>
          
          
          
          <li class="nav-item dropdown py-0">
            <a class="nav-link dropdown-toggle py-0" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Documentation
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/archives/4.2.8-series">4.2.8-series</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/archives/4.2.6-series">4.2.6-series</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/archives/4.2.4-series">4.2.4-series</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/archives/4.2.2-series">4.2.2-series</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/archives/4.2.0">4.2.0</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/archives/4.1.2">4.1.2</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/archives/4.1.1">4.1.1</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/archives/4.1.0">4.1.0</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://doc.ntp.org/archives/3-5.93e">3-5.93e</a>
              
            </div>
          </li>
          
          
        </ul>
      </div>
	  
      <script async src="https://cse.google.com/cse.js?cx=bb3c9b3e375d856be"></script>
      <div class="gcse-search">
      </div>

    </nav>
  </div>
  <div class="header-border">
  </div>
</header>
<!-- /navigation --><nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="https://doc.ntp.org/documentation/">Documentation</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://doc.ntp.org/archives/hints/">Hints</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://doc.ntp.org/archives/hints/notes-xntp-v3/">Notes for NTPv3</a>
</li>

	</ol>
</nav	>


<section class="section pt-0  pb-auto">
  <div class="container">
  	<h1>Notes for NTPv3</h1>
     
    <p>This version operates in much the same manner as Version 2 with the following changes and additions:</p>
<ol>
<li>
<p>The protocol machinery operates in conformance with the <a href="/reflib/rfc/rfc1305/rfc1305b.pdf">RFC 1305</a> NTP Version 3 specification. The most visible characteristic of this version is that the poll intervals for all polls, even selected ones, is significantly increased. This is especially desirable when serving a large client population. This implementation supports previous versions as non-configured peers; for version-2 configured peers a <code>version 2</code> keyword should be included on the <code>peer</code> line.</p>
</li>
<li>
<p>The configuration file has a new keyword: <code>statfile &lt;file&gt;</code>, where <code>&lt;file&gt;</code> is the name of a statistics file. When present, each clock update generates an entry of the form:</p>
<p><code>&lt;day&gt; &lt;sec&gt;.&lt;frac&gt; &lt;addr&gt; &lt;status&gt; &lt;offset&gt; &lt;delay&gt; &lt;disp&gt;</code></p>
<p>where <code>&lt;day&gt;</code> is the modified Julian day, <code>&lt;sec&gt;.&lt;frac&gt;</code> is the time of day, <code>&lt;addr&gt;</code> is the peer address and <code>&lt;status&gt;</code> is the peer status. The <code>&lt;offset&gt;, &lt;delay&gt;</code> and <code>&lt;disp&gt;</code> are the measured offset, delay and dispersion, respectively, of the peer clock relative to the local clock. About once per day the current file is closed and a new one created with names <code>&lt;file&gt;.&lt;gen&gt;</code>, where <code>&lt;gen&gt;</code> starts at one and increments for each new generation.</p>
</li>
<li>
<p>A number of additional platforms are supported. See <code>./Config</code> file for details.</p>
</li>
<li>
<p>A driver for the TrueTime 468DC GOES Synchronized Clock is included. This driver (<code>refclock_goes.c</code>) should also work for other TrueTime radio clocks, since all use the same format.</p>
</li>
<li>
<p>A replacement driver for the Spectracom 8170 WWVB Synchronized Clock is included. This driver (<code>refclock_wwvb.c</code>) (a) does not require a 1-pulse-per-second signal, (b) supports both format 0 (original 8170) and format 2 (Netclock/2 and upgraded 8170), (c) can be connected to more than one computer and (d) automatically compensates for all serial baud rates.</p>
</li>
<li>
<p>A driver for the German time/frequency station DCF77 is included. This requires a special STREAMS module.</p>
</li>
<li>
<p>In Version 2 special line-discipline modules were required for the CHU and WWVB drivers. This code continues to work in Version 3, although it is no longer needed for the WWVB driver. However, this code does not work under STREAMS, as used in SunOS 4.1.1. Equivalent STREAMS modules are supplied with Version 3.</p>
</li>
<li>
<p>Support for an external 1-pulse-per-second (pps) signal is provided. The signal is connected to a serial port (see <code>xntpd/ntp_loopfilter.c</code> for details). When present the leading edge of the pulse establishes the on-time epoch within an interval established by the selected radio clock or other NTP time server. Use of the pps is indicated when the tattletale displayed by <code>ntpq</code> changes from <code>*</code> to <code>o</code>.</p>
</li>
<li>
<p>The clock-selection and poll-update procedures have been modified slightly in order to achieve better performance on high speed LANs with compromise in performance on typical WANs.</p>
</li>
<li>
<p>In order to comply with U.S. Commerce Department regulations, the DES encryption routine <code>lib/authdes.c</code> cannot be exported. For exportable versions of this distribution a DES-encrypted version of this routine <code>lib/authdes.c.des</code> is included along with an unencrypted version <code>lib/authdes.c.export</code>, which allows normal operation, but without the NTP authentication feature. Further information is available in the <code>lib/authdes.c.export</code> file.</p>
</li>
<li>
<p>As an alternative to the DES-based authentication mechanism, an implementation of the RSA Message Digest 5 algorithm is provided. (see applicable copyright information in the library files).</p>
</li>
<li>
<p>A driver for the Magnavox MX4200 GPS clock.</p>
</li>
<li>
<p>A STREAMS module which captures carrier-detect data-lead transitions to connect a precision source of 1-pps, yet avoid the ugly overhead in the usual STREAMS processing. See the <code>ppsclock</code> subdirectory.</p>
</li>
<li>
<p>Support for the Apple A/UX operating system and enhanced support for the Hewlet-Packard HP/UX operating system. See the various <code>README</code> and <code>Config</code> files for further information.</p>
</li>
</ol>
<p>See the <code>COPYRIGHT</code> file for authors and copyright information. Note that some modules in this distribution contain copyright information that supersedes the copyright information in that file.</p>
<p>If I missed something or neglected to give due credit, please advise.</p>
<dl>
<dt>David L. Mills</dt>
<dd>University of Delaware</dd>
<dd>31 May 1992, amended 23 July 1992, 25 October 1992</dd>
</dl>
<h4 id="bugs-and-notes">Bugs and notes</h4>
<p>A bug in the original <code>tty_clk_STREAMS.c</code> module has been fixed.</p>
<p>The poll-interval randomization feature of poll_update (in <code>xntpd/ntp_proto.c</code>) has been extended to apply when the poll interval is increased, as well as reduced. This spreads the update messages in time
and helps avoid unpleasant bursts of messages.</p>
<p>In the <code>clock_select</code> algorithm the peers selected for combining are limited to those survivors at the lowest stratum, not the entire list. This helps avoid whiplash when large numbers of peers are at the same
stratum.</p>
<p>The number formerly displayed by <code>ntpq</code> as &ldquo;compliance&rdquo; is now the time constant of integration.</p>
<p>The DNS resolver <code>xntpd/ntp_intres.c</code> is now integrated into <code>xntpd</code>, making configuration of multiple hosts easier.</p>
<p>System and peer events are now written to the system log at priority <code>LOG_INFO</code>.</p>
<p>The leap-second code was fixed to avoid broadcasting leap warnings on all except the last day of June and December.</p>

	  
	  <style>
  .feedback--answer {
    display: inline-block;
  }
  .feedback--answer-no {
    margin-left: 1em;
  }
  .feedback--response {
    display: none;
    margin-top: 1em;
  }
  .feedback--response__visible {
    display: block;
  }
</style>
<div>
<h2 class="feedback--title">Feedback</h2>
<p class="feedback--question">Was this page helpful?</p>
<button class="btn-primary mb-5 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn-primary mb-5 feedback--answer feedback--answer-no">No</button>
<p class="feedback--response feedback--response-yes">
  Glad to hear it!</a>
</p>
<p class="feedback--response feedback--response-no">
  Sorry to hear that.</a>
</p>
</div>
<script>
  const yesButton = document.querySelector('.feedback--answer-yes');
  const noButton = document.querySelector('.feedback--answer-no');
  const yesResponse = document.querySelector('.feedback--response-yes');
  const noResponse = document.querySelector('.feedback--response-no');
  const disableButtons = () => {
    yesButton.disabled = true;
    noButton.disabled = true;
  };
  const sendFeedback = (value) => {
    if (typeof ga !== 'function') return;
    const args = {
      command: 'send',
      hitType: 'event',
      category: 'Helpful',
      action: 'click',
      label: window.location.pathname,
      value: value
    };
    ga(args.command, args.hitType, args.category, args.action, args.label, args.value);
  };
  yesButton.addEventListener('click', () => {
    yesResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(1);
  });
  noButton.addEventListener('click', () => {
    noResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(0);
  });
</script>

	  <br />
	
  </div>
</section>
<footer class="navbar site-footer fixed-bottom py-0">
  <ul class="mx-auto">
    
    <li class="navbar-text" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
      <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ntp">
        <i class="bi-twitter"></i>
      </a>
    </li>
    
    <li class="navbar-text" data-toggle="tooltip" data-placement="top" title="LinkedIn" aria-label="LinkedIn">
      <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/groups/4651343">
        <i class="bi-linkedin"></i>
      </a>
    </li>
    
    <li class="navbar-text" data-toggle="tooltip" data-placement="top" title="Facebook" aria-label="Facebook">
      <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/networktimeprotocol">
        <i class="bi-facebook"></i>
      </a>
    </li>
    
    <li class="navbar-text">
      <p>&copy; 2022 <a class="navbar-text text-white" href="https://www.nwtime.org">Network Time Foundation</a></p>	
    </li>
  </ul>
</footer>

</body>
</html>