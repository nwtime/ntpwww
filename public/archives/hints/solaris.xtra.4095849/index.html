<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.84.1" /><META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Solaris Bug #4095849 | NTP: Network Time Protocol</title>
<meta name="description" content="NTP Documentation Archive"><meta property="og:title" content="Solaris Bug #4095849" />
<meta property="og:description" content="Bug Id: 4095849 Category: kernel Subcategory: syscall State: evaluated Synopsis: time_constant value 6 with PLL in use leads to integer divide zero trap panic Description: If the time_constant parameter is 7 or higher, and the phase-lock looping model is in use, the system will take a &#34;integer divide zero trap&#34; panic in the clock routine as soon as the time_offset becomes non-zero. time_constant defaults to 0\. The only place it is set is in the ntp_adjtime system call, from the &#39;constant&#39; element of the timex structure argument." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/archives/hints/solaris.xtra.4095849/" /><meta property="article:section" content="archives" />

<meta property="og:site_name" content="NTP: Network Time Protocol" />

<meta itemprop="name" content="Solaris Bug #4095849">
<meta itemprop="description" content="Bug Id: 4095849 Category: kernel Subcategory: syscall State: evaluated Synopsis: time_constant value 6 with PLL in use leads to integer divide zero trap panic Description: If the time_constant parameter is 7 or higher, and the phase-lock looping model is in use, the system will take a &#34;integer divide zero trap&#34; panic in the clock routine as soon as the time_offset becomes non-zero. time_constant defaults to 0\. The only place it is set is in the ntp_adjtime system call, from the &#39;constant&#39; element of the timex structure argument.">

<meta itemprop="wordCount" content="415">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Solaris Bug #4095849"/>
<meta name="twitter:description" content="Bug Id: 4095849 Category: kernel Subcategory: syscall State: evaluated Synopsis: time_constant value 6 with PLL in use leads to integer divide zero trap panic Description: If the time_constant parameter is 7 or higher, and the phase-lock looping model is in use, the system will take a &#34;integer divide zero trap&#34; panic in the clock routine as soon as the time_offset becomes non-zero. time_constant defaults to 0\. The only place it is set is in the ntp_adjtime system call, from the &#39;constant&#39; element of the timex structure argument."/>




<link rel="preload" href="/scss/main.min.c7590aab2525bc59dfb1dc16e6ad51978d04d1687ab16e19453b88b4ff42ceea.css" as="style">
<link href="/scss/main.min.c7590aab2525bc59dfb1dc16e6ad51978d04d1687ab16e19453b88b4ff42ceea.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>





  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"></span><span class="text-uppercase font-weight-bold">NTP: Network Time Protocol</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			
			<li class="nav-item dropdown d-none d-lg-block">
				<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	Docs
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="/archives/4.2.8-series/toc">4.2.8-series</a>
	
	<a class="dropdown-item" href="/archives/4.2.6-series/toc">4.2.6-series</a>
	
	<a class="dropdown-item" href="/archives/4.2.4-series/toc">4.2.4-series</a>
	
	<a class="dropdown-item" href="/archives/4.2.2-series/toc">4.2.2-series</a>
	
	<a class="dropdown-item" href="/archives/4.2.0/toc">4.2.0</a>
	
	<a class="dropdown-item" href="/archives/4.1.2/toc">4.1.2</a>
	
	<a class="dropdown-item" href="/archives/4.1.1/toc">4.1.1</a>
	
	<a class="dropdown-item" href="/archives/4.1.0/toc">4.1.0</a>
	
</div>

			</li>
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="/archives/">Docs</a>
</li>




<li class="breadcrumb-item" >
	<a href="/archives/hints/">Hints</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="/archives/hints/solaris.xtra.4095849/">Solaris Bug #4095849</a>
</li>

	</ol>
</nav	>

            
<div class="td-content">
	<h1>Solaris Bug #4095849</h1>
    
	       
	<pre> Bug Id: 4095849
 Category: kernel
 Subcategory: syscall
 State: evaluated
 Synopsis: time_constant value >6 with PLL in use leads to integer divide
           zero trap panic
 Description:
If the time_constant parameter is 7 or higher, and the phase-lock looping model
is in use, the system will take a "integer divide zero trap" panic in
the clock routine as soon as the time_offset becomes non-zero.

time_constant defaults to 0\.  The only place it is set is in the ntp_adjtime
system call, from the 'constant' element of the timex structure argument.

 Work around:
Never set the constant element of the timex structure passed to ntp_adjtime to
a value larger than 6.

satish.mynam@Eng 1998-04-30
1. Use Sun's version of NTP software instead of PD version. This problem
is not seen with Sun's NTP version (which is mostly eqivalent to PD NTP 3.4
plus some Sun's local functionality futures).

2. Workaround for the public domain NTP version  ONLY:
 =====================================================
The workaround for public domain NTP version is to disable the
KERNEL_PLL from the NTP code. This way ntp_Adjtime() system call is
totally bypassed without sacrificing any of the functionality of the
NTP. The only hit you might see is the way  kernel precision timminig
is done without the PLL algorithm in the kernel.

    The easiest way to disable ntp_adjtime option is(without changing
    any makefiles or other config files) to disable the KERNEL_PLL
    value in the ./config.h file.

After doing a ./configure for probing for all the necessary tools(compilers,
os version, libraries),  please comment out KERNEL_PLL macro in
the ./config.h  file.  This will disable the KERNEL_PLL part of the source
code and the newly obtained xntpd is just similar to the old one but it
does not use ntp_adjtime() system call. This prevents it from panic'ng
the kernel.

/*#define KERNEL_PLL 1*/

I complied a new xntpd binary this way and it does nothave any ntp_adjtime()
related stuff.

Default:
=======
/net/divya/export/home/mynam/public_domain/ntp/xntp3-5.92/xntpd>strings
xntpd |
grep ntp_adjtime
354:adj_frequency: ntp_adjtime failed: %m
357:loop_config: ntp_adjtime() failed: %m
435:get_kernel_info: ntp_adjtime() failed: %m

With KERNEL_PLL disabled in config.h file
-=======================

/net/divya/export/home/mynam/public_domain/ntp/xntp3-5.92/xntpd>strings
xntpd.nopll | grep ntp_adjtime

        Integrated in releases:
 Duplicate of:
 Patch id:
 See also: 4133517
 Summary:
If the time_constant parameter is 7 or higher, and the phase-lock looping model
is in use, the system will take a "integer divide zero trap" panic in
the clock routine as soon as the time_offset becomes non-zero.

time_constant defaults to 0\.  The only place it is set is in the ntp_adjtime
system call, from the 'constant' element of the timex structure argument.
----------------------------------------------------------------------------

</pre>

	
	
</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Mailing lists" aria-label="Mailing lists">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://lists.ntp.org/listinfo">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ntp">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="LinkedIn" aria-label="LinkedIn">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/groups/4651343">
      <i class="fab fa-linkedin-in"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Facebook" aria-label="Facebook">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/networktimeprotocol">
      <i class="fab fa-facebook-f"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2021 Network Time Foundation All Rights Reserved</small>
        
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>






 











<script src="/js/main.min.5c74b870c6953931a705f390a49c7e4c0a842ec5c83b24354758dd674343ed0d.js" integrity="sha256-XHS4cMaVOTGnBfOQpJx&#43;TAqELsXIOyQ1R1jdZ0ND7Q0=" crossorigin="anonymous"></script>




  </body>
</html>