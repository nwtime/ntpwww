<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="UTF-8">
  <title>Autokey Identity Schemes</title>

  <!-- Mobile Responsive Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="NTP Documentation Archive">
  
  <meta name="generator" content="Hugo 0.84.1" />

  <!-- Plugins -->
  
    <link rel="stylesheet" href="https://necolas.github.io/normalize.css/latest/normalize.css">
  
    <link rel="stylesheet" href="/plugins/bootstrap/bootstrap.min.css">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="/scss/nwtime.min.css" media="screen">

  <!-- Favicon -->
  <link rel="shortcut icon" href="/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="/images/favicon.png " type="image/x-icon">
</head>
<body><!-- navigation -->
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

<header class="sticky-top navigation">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-light py-0">
		<div class="d-flex align-items-center" style="height:100px; width:100px;">
		 <a class="navbar-brand py-0" href="/"><img class="img-fluid" src="/icons/ntp_logo.jpg" alt="NTP: Network Time Protocol"></a> 
      </div>
	  <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="bi-plus"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <ul class="navbar-nav ml-auto py-0">
          <li class="nav-item py-0">
            <a class="nav-link py-0" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/"></a>
          </li>
          
          
          <li class="nav-item py-0">
            <a class="nav-link py-0" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="https://www.nwtime.org">Network Time Foundation</a>
          </li>
          
          
          
          <li class="nav-item dropdown py-0">
            <a class="nav-link dropdown-toggle py-0" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Reference Library
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/reflib/brief">Briefs</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/reflib/memos">Memos</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/reflib/reports">Reports</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/reflib/rfc">RFCs</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/reflib/software">Software</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/reflib/papers">White Papers</a>
              
            </div>
          </li>
          
          
          
          <li class="nav-item dropdown py-0">
            <a class="nav-link dropdown-toggle py-0" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Docs
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/archives/4.2.8-series/toc">4.2.8-series</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/archives/4.2.6-series/toc">4.2.6-series</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/archives/4.2.4-series/toc">4.2.4-series</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/archives/4.2.2-series/toc">4.2.2-series</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/archives/4.2.0/toc">4.2.0</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/archives/4.1.2/toc">4.1.2</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/archives/4.1.1/toc">4.1.1</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/archives/4.1.0/toc">4.1.0</a>
              
              <a class="dropdown-item" style="text-decoration: none; font-size: 16px; font-family: 'Nunito Sans', sans-serif;" href="/archives/3-5.93e/toc">3-5.93e</a>
              
            </div>
          </li>
          
          
        </ul>

      </div>
    </nav>
  </div>
  <div class="header-border">
  </div>
</header>
<!-- /navigation --><nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		







<li class="breadcrumb-item" >
	<a href="/reflib/">Reference Library</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="/reflib/ident/">Autokey Identity Schemes</a>
</li>

	</ol>
</nav	>


<section class="section pt-0  pb-auto">
  <div class="container">
  	<h1>Autokey Identity Schemes</h1>
     
    <p><img src="/archives/pic/alautun4a.gif" alt="gif"></p>
<p><a href="/reflib/maya">Maya glyph <em>alautun</em></a></p>
<h4 id="table-of-contents">Table of Contents</h4>
<ul>
<li><a href="/reflib/ident/#briefing-slides">Briefing Slides</a></li>
<li><a href="/reflib/ident/#related-pages">Related Pages</a></li>
<li><a href="/reflib/ident/#introduction">Introduction</a></li>
<li><a href="/reflib/ident/#private-certificate-pc-cryptosystem">Private Certificate (PC) Cryptosystem</a></li>
<li><a href="/reflib/ident/#schnorr-iff-cryptosystem">Schnorr (IFF) Cryptosystem</a></li>
<li><a href="/reflib/ident/#guillou-quisquater-gq-cryptosystem">Guillou-Quisquater (GQ) Cryptosystem</a></li>
<li><a href="/reflib/ident/#mu-varadharajan-mv-cryptosystem">Mu-Varadharajan (MV) Cryptosystem</a></li>
<li><a href="/reflib/ident/#selected-publications">Selected Publications</a></li>
</ul>
<hr>
<h4 id="briefing-slides">Briefing Slides</h4>
<ul>
<li>NTP Security Model <a href="/reflib/brief/autokey/autokey.pdf">PDF</a></li>
<li>NTP Security Algorithms <a href="/reflib/brief/secalgor/secalgor.pdf">PDF</a></li>
<li>NTP Security Protocol <a href="/reflib/brief/secproto/secproto.pdf">PDF</a></li>
</ul>
<hr>
<h4 id="related-pages">Related Pages</h4>
<ul>
<li><a href="/reflib/autocfg">Autonomous Configuration</a></li>
<li><a href="/reflib/autokey">Autonomous Authentication</a></li>
<li><a href="/reflib/proto">Autokey Protocol</a></li>
<li><a href="/reflib/ident">Autokey Identity Schemes</a></li>
</ul>
<hr>
<h4 id="introduction">Introduction</h4>
<p>While the identity scheme described in RFC-2875 is based on a ubiquitous Diffie-Hellman infrastructure, it is expensive to generate and use when compared to others described here. There are five schemes now implemented in Autokey to prove identity: (1) trusted certificates (TC), (2) private certificates (PC), (3) a modified Schnorr algorithm (IFF aka Identify Friendly or Foe), (4) a modified Guillou-Quisquater algorithm (GQ), and (5) a modified Mu-Varadharajan algorithm (MV). The TC scheme, which involves a certificate trail to a trusted host, is discussed on the <a href="/reflib/proto">Autokey Protocol</a> page. Each of the others involves generating parameters specific to the scheme, together with public and private values used by the scheme.</p>
<p>In order to simplify implementation, each scheme uses existing structures in the OpenSSL library, including those for RSA and DSA cryptography. As these structures are sometimes used in ways far different than their original purpose, they are called cuckoo structures in the descriptions that follow.</p>
<p><img src="/archives/pic/xchange.gif" alt="gif"></p>
<p>In the challenge-response schemes client Alice asks server Bob to prove identity relative to a secret group key <em>b</em> provided by a trusted authority (TA). As shown in the figure above, client Alice rolls random <em>nonce1</em> and sends to server Bob. Bob rolls random <em>nonce2</em>, performs some mathematical function and returns the response along with the hash of some private value to Alice. Alice performs another mathematical function and verifies the result matches the hash in Bob&rsquo;s message.</p>
<p>Each of the five schemes is intended for specific use. There are three kinds of keys, trusted agent, server and client. Servers can be clients of other servers, but clients cannot be servers for dependent clients. In general, the goals of the schemes are that clients cannot masquerade as a servers and a servers cannot masquerade as a trusted agents (TAs), but they differ somewhat on how to achieve these goals. To the extent that identity can be verified without revealing the group key, the schemes are properly described as zero-knowledge proofs.</p>
<p>The four identity schemes described here have different design goals and are intended for specific application. The PC scheme is intended for one-way broadcast configurations where clients cannot run a duplex protocol. It is essentially a symmetric key cryptosystem where the certificate itself is the key.</p>
<p>The IFF scheme is intended for servers operated by national laboratories. The servers share a private group key and provide the public client parameters on request. The clients cannot masquerade as servers.</p>
<p>The GQ scheme is intended for exceptionally hostile scenarios where it is necessary to change the client key at relatively frequent intervals. As in the IFF scheme the servers share a private group key and provide the public client parameters on request. In this scheme clients requre a public key to complete the exchange. This is conveyed in the server certificate in an extension field. The certificate can be changed while retaining the same group key.</p>
<p>The MV scheme is intended for the most challenging scenarios where it is necessary to protect against both server and client masquerade. The private values used by the TA to generate the cryptosystem are not available to the servers and the private values used by the servers to encrypt data are not available to the clients. Thus, a client cannot masquerade as a server and a server cannot masquerade as a TA. However, a client can verify a server has the correct group key even though neither the client nor server know the group key, nor can either manufacture a client key acceptable to any other client. A further feature of this scheme is that the TA can collaborate with the servers to revoke client keys.</p>
<hr>
<h4 id="private-certificate-pc-cryptosystem">Private Certificate (PC) Cryptosystem</h4>
<p><img src="/archives/pic/pc.gif" alt="gif"></p>
<p>The PC scheme shown above uses a private certificate as the group key. A certificate is designated private by a X509 Version 3 extension field when generated by the <tt>ntp-keygen</tt> program in the NTP software distribution. In the Autokey context it functions as a symmetric key. The private certificate is generated by a TA and distributed to all group members by secure means and is never revealed outside the group. A client is marked trusted in the (optional) Parameter Exchange and authentic when the first signature is verified. This scheme is cryptographically strong as long as the private certificate is protected; however, it can be very awkward to refresh the keys or certificate, since new values must be securely distributed to a possibly large population and activated simultaneously.</p>
<hr>
<h4 id="schnorr-iff-cryptosystem">Schnorr (IFF) Cryptosystem</h4>
<p>The Schnorr (IFF) identity scheme can be used when certificates are generated by utilities other than the <tt>ntp-keygen</tt> program in the NTP software distribution. Certificates can be generated by the OpenSSL library or an external public certificate authority, but conveying an arbitrary public value in a certificate extension field might not be possible. The TA generates the IFF parameters, private key and public key, then sends these values to the servers and the parameters and public key to the clients. Without the private key a client cannot masquerade as a legitimate server.</p>
<p>The DSA parameters are generated by routines in the OpenSSL library. The IFF values hide in a DSA cuckoo structure which uses the same parameters. The values are used by an identity scheme based on DSA cryptography and described in <sup><a href="#myfootnote4">4</a></sup> and <sup><a href="#myfootnote5">5</a></sup> p. 285. The <em>p</em> is a 512-bit prime, <em>g</em> a generator of the multiplicative group <em>Z<sub>p</sub></em>* and _q_ a 160-bit prime that divides _p_ - 1 and is a _q_th root of 1 mod _p_; that is, _g<sup>q</sup>_ = 1 mod _p_. The TA rolls a private random group key _b_ (0 &lt; _b_ &lt; _q_) and computes the public key _v_ = _g<sup>b</sup>_, then distributes private (_p_, _q_, _g_, _b_) to the servers using secure means and public (_p_, _q_, _g, v_) to the clients not necessarily using secure means.</p>
<p><img src="/archives/pic/iff.gif" alt="gif"></p>
<p>The TA generates a DSA parameter structure for use as IFF parameters. The IFF parameters are identical to the DSA parameters, so the OpenSSL library DSA parameter generation routine can be used directly. The DSA parameter structure is written to a file as an encrypted DSA key encoded in PEM. Unused structure members are set to one.</p>
<table>
<thead>
<tr>
<th>IFF</th>
<th>DSA</th>
<th>Item</th>
<th>Include</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>p</em></td>
<td><tt>p</tt></td>
<td>modulus</td>
<td>all</td>
</tr>
<tr>
<td><em>q</em></td>
<td><tt>q</tt></td>
<td>modulus</td>
<td>all</td>
</tr>
<tr>
<td><em>g</em></td>
<td><tt>g</tt></td>
<td>generator</td>
<td>all</td>
</tr>
<tr>
<td><em>b</em></td>
<td><tt>priv_key</tt></td>
<td>group key</td>
<td>server</td>
</tr>
<tr>
<td><em>v</em></td>
<td><tt>pub_key</tt></td>
<td>client key</td>
<td>client</td>
</tr>
</tbody>
</table>
<p>Alice challenges Bob to confirm identity using the following protocol exchange.</p>
<ol>
<li>Alice rolls random <em>r</em> (0 &lt; <em>r</em> &lt; <em>q</em>) and sends to Bob.</li>
<li>Bob rolls random <em>k</em> (0 &lt; <em>k</em> &lt; <em>q</em>), computes <em>y</em> = <em>k</em> + <em>b r</em> mod <em>q</em> and <em>x</em> = <em>g</em>_<sup>k</sup>_ mod _p_, then sends (_y_, hash(_x_)) to Alice.</li>
<li>Alice computes <em>z</em> = <em>g<sup>y</sup></em> <em>v<sup>r</sup></em> mod <em>p</em> and verifies hash(<em>z</em>) equals hash(<em>x</em>).</li>
</ol>
<hr>
<h4 id="guillou-quisquater-gq-cryptosystem">Guillou-Quisquater (GQ) Cryptosystem</h4>
<p>The Guillou-Quisquater (GQ) identity scheme is useful when certificates are generated by the <tt>ntp-keygen</tt> program in the NTP software distribution. The TA generates the GQ parameters, private key and public key, then sends these values to the servers and the parameters to the clients. The public key is inserted in an X.509 extension field when the certificate is generated. Without the private key a client cannot masquerade as a legitimate server.</p>
<p>The RSA parameters are generated by routines in the OpenSSL libbrary. The GQ values hide in a RSA cuckoo structure which uses the same parameters. The values are used in an identity scheme based on RSA cryptography and described in <sup><a href="#myfootnote1">1</a></sup> and <sup><a href="#myfootnote5">5</a></sup> p. 300 (with errors). The 512-bit public modulus <em>n</em> = <em>p</em> <em>q</em>, where <em>p</em> and <em>q</em> are secret large primes. The TA rolls random group key <em>b</em> (0 &lt; <em>b</em> &lt; <em>n</em>) and sends (<em>n</em>, <em>b</em>) to the servers using secure means. The private key and public key are constructed later.</p>
<p><img src="/archives/pic/gq.gif" alt="gif"></p>
<p>The TA generates a RSA parameter structure for use as GQ parameters. The RSA parameter structure is written to a file as an encrypted RSA key encoded in PEM. Unused structure members are set to one.</p>
<p>When generating new certificates, the server rolls new random private key <em>u</em> (0 &lt; <em>u</em> &lt; <em>n</em>) and public key its inverse <em>u</em><sup>-1</sup> obscured by the group key <em>v</em> = <em>u</em><sup>-1</sup> <em><sup>b</sup></em>. These values replace the private and public keys normally generated by the RSA scheme. In addition, the public key <em>v</em> is conveyed in a X.509 certificate extension.</p>
<table>
<thead>
<tr>
<th>GQ</th>
<th>RSA</th>
<th>Item</th>
<th>Include</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>n</em></td>
<td><tt>n</tt></td>
<td>modulus</td>
<td>all</td>
</tr>
<tr>
<td><em>b</em></td>
<td><tt>e</tt></td>
<td>group key</td>
<td>all</td>
</tr>
<tr>
<td><em>u</em></td>
<td><tt>p</tt></td>
<td>server key</td>
<td>server</td>
</tr>
<tr>
<td><em>v</em></td>
<td><tt>q</tt></td>
<td>client key</td>
<td>client</td>
</tr>
</tbody>
</table>
<p>Alice challenges Bob to confirm identity using the following exchange.</p>
<ol>
<li>Alice rolls random <em>r</em> (0 &lt; <em>r</em> &lt; <em>n</em>) and sends to Bob.</li>
<li>Bob rolls random <em>k</em> (1 &lt; <em>k</em> &lt; <em>n</em>) and computes <em>y</em> = <em>k</em> <em>u<sup>r</sup></em> mod <em>n</em> and <em>x</em> = <em>k<sup>b</sup></em> mod <em>n</em>, then sends (<em>y</em>, hash(<em>x</em>)) to Alice.</li>
<li>Alice computes <em>z</em> = <em>v<sup>r</sup> y<sup>b</sup></em> mod <em>n</em> and verifies hash(<em>z</em>) equals hash(<em>x</em>).</li>
</ol>
<hr>
<h4 id="mu-varadharajan-mv-cryptosystem">Mu-Varadharajan (MV) Cryptosystem</h4>
<p>The Mu-Varadharajan (MV) scheme was originally intended to encrypt broadcast transmissiions to receivers which do not transmit. There is one encryption key for the broadcaster and a separate decryption key for each receiver. It operates something like a pay-per-view satellite broadcasting system where the session key is encrypted by the broadcaster and the decryption keys are held in a tamperproof set-top box. We don&rsquo;t use it this way, but read on.</p>
<p>In the MV scheme the TA constructs an intricate cryptosystem involving a number of activation keys known only to the TA. The TA decides which keys to activate and provides to the servers an encryption key <em>E</em> and server decryption keys <em>gbar and</em> <em>ghat</em> which depend on the activated keys. The servers have no additional information and, in particular, cannot masquerade as a TA. In addition, the TA provides for each activation key <em>j</em> individual client decryption keys _xbar_and <em>xhat</em>, which do not need to be changed if the TA enables or disables an activation key. The clients have no further information and, in particular, cannot masquerade as a server or TA.</p>
<p>Clients are assigned one of the activation keys and are provided with the corresponding client key. There can be any number of clients sharing the same activation key according to policy. While the machinery to enable and disable ativation keys is included in the current implementation, specific means and interfaces to do this are not yet available, so only one client key is provided.</p>
<p>The scheme is designed so that clients can construct the inverse of <em>E</em> from the server <em>gbar</em> and <em>ghat</em> and client <em>xbar</em> and <em>xhat</em>. In the scheme both <em>E</em> and its inverse are exponentiated by a server nonce, so the product is always one and the secrecy depends on the descrete log problem.</p>
<p>The MV values hide in a DSA cuckoo structure which uses the same parameters, but generated in a different way. The values are used in an encryption scheme similar to El Gamal cryptography and use a polynomial formed from the expansion of product terms (<em>x</em> - <em>x<sub>j</sub></em>), as described in <sup><a href="#myfootnote3">3</a></sup>. The paper has significant errors and serious omissions.</p>
<p><img src="/archives/pic/mv.gif" alt="gif"></p>
<p>The TA generates the modulus, encryption key and server decryption keys as an encrypted DSA key encoded in PEM. Unused structure members are set to one.</p>
<table>
<thead>
<tr>
<th>MV</th>
<th>DSA</th>
<th>Item</th>
<th>Include</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>p</em></td>
<td><tt>p</tt></td>
<td>modulus</td>
<td>all</td>
</tr>
<tr>
<td><em>q</em></td>
<td><tt>q</tt></td>
<td>modulus</td>
<td>server</td>
</tr>
<tr>
<td><em>E</em></td>
<td><tt>g</tt></td>
<td>private encrypt key</td>
<td>server</td>
</tr>
<tr>
<td><em>gbar</em></td>
<td><tt>priv_key</tt></td>
<td>server decrypt key</td>
<td>server</td>
</tr>
<tr>
<td><em>ghat</em></td>
<td><tt>pub_key</tt></td>
<td>server decrypt key</td>
<td>server</td>
</tr>
</tbody>
</table>
<p>The TA generates the modulus and client decryption keys as a nonencrypted DSA key encoded in PEM. It is used only by designated recipient(s) who pay a suitably outrageous fee for its use. Unused structure members are set to one.</p>
<table>
<thead>
<tr>
<th>MV</th>
<th>DSA</th>
<th>Item</th>
<th>Include</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>p</em></td>
<td><tt>p</tt></td>
<td>modulus</td>
<td>all</td>
</tr>
<tr>
<td><em>xbar</em></td>
<td><tt>priv_key</tt></td>
<td>client decrypt key</td>
<td>client</td>
</tr>
<tr>
<td><em>xhat</em></td>
<td><tt>pub_key</tt></td>
<td>client decrypt key</td>
<td>client</td>
</tr>
</tbody>
</table>
<p>The devil is in the details. Let <em>q</em> be the product of <em>n</em> distinct primes <em>s_1</em><sub>j</sub>_ (_j_ = 1&hellip;_n_), where each _s_1_<sub>j</sub>_, also called an activation key, has _m_ significant bits. Let prime _p_ = 2_q_ + 1, so that _q_ and each _s_1_<sub>j</sub>_ divide _p_ - 1 and _p_ has _M_ = _n__m_ + 1 significant bits. Let _g_ be a generator of the multiplicative group _Z<sub>p</sub>_*; that is, gcd(_g_, _p_ - 1) = 1 and _g<sup>q</sup>_ = 1 mod _p_. We do modular arithmetic over _Z<sub>q</sub>_ and then project into _Z<sub>p</sub>_* as powers of _g._ Sometimes we have to compute an inverse _b_<sup>-1</sup> of random _b_ in _Z<sub>q</sub>_, but for that purpose we require gcd(_b_, _q_) = 1. We expect _M_ to be in the 500-bit range and _n_ relatively small, like 30. The TA uses a nasty probabilistic algorithm to generate the cryptosystem. In the following let the number of bits in the modulus _m_ = 512.</p>
<ol>
<li>The object is to generate a multiplicative group <em>Z<sub>p</sub></em>* modulo a prime _p_ and a subset _Z<sub>q</sub>_ mod _q_, where _q_ is the product of _n_ distinct _m_-bit primes _s_1_<sub>j</sub>_ (_j_ = 1&hellip;_n_) and _q_ divides _p_ - 1. As a practical matter, it is tough to find more than 31 distinct primes for _mn_ = 512 or 61 primes for _mn_ = 1024. The latter can take several hundred iterations and several minutes on a Sun Blade 1000.</li>
<li>Compute the modulus <em>q</em> as the product of the primes. Compute the modulus <em>p</em> as 2_q_ + 1 and test _p_ for primality. If _p_ is composite, replace one of the primes with a new distinct prime and try again. Note that _q_ will hardly be a secret since we have to reveal _p_ to servers and clients. However, factoring _q_ to find the primes should be adequately hard, as this is the same problem considered hard in RSA. Question: is it as hard to find _n_ small prime factors totalling _n_ bits as it is to find two large prime factors totalling _n_ bits? Remember, the bad guy doesn&rsquo;t know _n_.</li>
<li>Associate with each <em>s_1</em><sub>j</sub>_ an element _s<sub>j</sub>_ such that _s<sub>j</sub>_ _s_1_<sub>j</sub>_ = _s_1_<sub>j</sub>_ mod _q_. One way to find an _s<sub>j</sub>_ is to compute the quotient (_q_ + _s_1_<sub>j</sub>_) / _s_1_<sub>j</sub> _mod _p_. The student should prove the remainder is always zero.</li>
<li>Compute the generator <em>g</em> of <em>Z<sub>p</sub></em> using a random roll such that gcd(<em>g</em>, <em>p</em> - 1) = 1 and <em>g<sup>q</sup></em> = 1. If not, roll again.</li>
</ol>
<p>The cryptosystem parameters <em>n</em>, <em>p</em>, <em>q</em>, <em>g</em>, <em>s_1</em><sub>j</sub><em>, <em>s</em>_<sub>j</sub></em> (<em>j</em> = 1&hellip;<em>n</em>) have been determined. The TA sets up a specific instance of the scheme as follows.</p>
<ol>
<li>Roll random roots <em>x<sub>j</sub></em> mod <em>q</em> (<em>j</em> = 1&hellip;<em>n</em>) for a polynomial of order <em>n</em>. While it may not be strictly necessary, Make sure each root has no factors in common with <em>q</em>.</li>
<li>Generate polynomial coefficients <em>a<sub>i</sub></em> (<em>i</em> = 0&hellip;<em>n</em>) from the expansion of root products (<em>x</em> - <em>x<sub>i</sub></em>) mod <em>q</em> in powers of <em>x</em> using a fast method contributed by Charlie Boncelet.</li>
<li>Generate <em>g<sub>i</sub></em> = <em>g<sup>ai</sup></em> mod <em>p</em> for all <em>i</em> and the generator <em>g</em>. Verify prod(<em>g<sub>i</sub><sup>ai</sup> <sup>xji</sup></em>) = 1 for all <em>i</em>, <em>j</em>. Note the <em>a<sub>i</sub> x<sub>j</sub><sup>i</sup></em> exponent is computed mod <em>q</em>, but the <em>g<sub>i</sub></em> is computed mod <em>p</em>. Also note the expression given in the paper cited is incorrect.</li>
<li>Make master encryption key <em>A</em> = Prod(<em>g<sub>i</sub><sup>xj</sup></em>) (<em>i</em> = 0&hellip;<em>n</em>, <em>j</em> = 1&hellip;<em>n</em> - 1). Keep it around for awhile, since it is expensive to compute.</li>
<li>Roll private random group key <em>b</em> mod <em>q</em> (0 &lt; <em>b</em> &lt; <em>q</em>), where gcd(<em>b</em>, <em>q</em>) = 1 to guarantee the inverse exists, then compute <em>b</em><sup>-1</sup> mod <em>q</em>. If <em>b</em> is changed, all keys must be recomputed.</li>
<li>Make private client keys <em>xbar<sub>j</sub></em> = <em>b</em><sup>-1</sup> Sum(<em>x<sub>i</sub><sup>n</sup></em> mod <em>q)</em> (<em>i</em> = 1&hellip;n, <em>i</em> != <em>j</em>) and <em>xhat<sub>j</sub></em> = <em>s<sub>j</sub>x<sub>j</sub><sup>n</sup></em> for all <em>j</em>. Note that the keys for the <em>j_th client involve only <em>s<sub>j</sub></em> and that <em>s_1</em><sub>j</sub></em> remain secret. The TA sends (<em>p</em>, <em>xbar<sub>j</sub></em>, <em>xhat<sub>j</sub></em>) to the _j_th client(s) using nonsecure means.</li>
<li>The activation key is initially <em>q</em> by construction. The TA revokes client <em>j</em> by dividing <em>q</em> by <em>s_1</em><sub>j</sub>_. The quotient becomes the activation key <em>s</em>. Note we always have to revoke one key; otherwise, the plaintext and cryptotext would be identical. The TA computes private server encryption key <em>E</em> = <em>A<sup>s</sup></em> and server decryption keys <em>gbar</em> = <em>gbar<sup>s</sup></em> and <em>ghat</em> = <em>ghat<sup>sb</sup></em> mod <em>p</em> and sends (<em>p</em>, <em>E</em>, <em>gbar</em>, <em>ghat</em>) to the servers using secure means. These values must be recomputed if an activation key is changed.</li>
</ol>
<p>Alice challenges Bob to confirm identity using the following exchange.</p>
<ol>
<li>Alice rolls random <em>r</em> (0 &lt; <em>r</em> &lt; <em>q</em>) and sends to Bob.</li>
<li>Bob rolls random <em>k</em> (0 &lt; <em>k</em> &lt; <em>q</em>), computes <em>y</em> = <em>rE<sup>k</sup></em>, <em>ybar</em> = _gbar<sup>k</sup> _and <em>yhat</em> = <em>ghat<sup>k</sup></em>, then returns (<em>y</em>, <em>ybar</em>, <em>yhat</em>) to Alice.</li>
<li>Alice computes the session decryption key (<em>E<sup>k</sup></em>)<sup>-1</sup> = <em>ybar<sup>xhatj</sup></em> <em>yhat<sup>xbarj</sup>__,</em> then verifies that <em>y</em> = <em>r.</em></li>
</ol>
<hr>
<h4 id="selected-publications">Selected Publications</h4>
<p><a name="myfootnote1">1</a>  Guillou, L.C., and J.-J. Quisquatar. A &ldquo;paradoxical&rdquo; identity-based signature scheme resulting from zero-knowledge. <em>Proc. CRYPTO 88 Advanced in Cryptology</em>, Springer-Verlag, 1990, 216-231.</p>
<p><a name="myfootnote2">2</a>  Mills, D.L. The Autokey security architecture, protocol and algorithms. Electrical and Computer Engineering Technical Report 06-1-1, University of Delaware, January 2006, 59 pp, <a href="/reflib/reports/stime1/stime.pdf">PDF</a>.</p>
<p><a name="myfootnote3">3</a>  Mu, Y., and V. Varadharajan. Robust and secure broadcasting. <em>Proc. INDOCRYPT 2001, LNCS 2247</em>, Springer Verlag, 2001, 223-231.</p>
<p><a name="myfootnote4">4</a>  Schnorr, C.P. Efficient signature generation for smart cards. <em>J. Cryptology 4, 3</em> (1991), 161-174.</p>
<p><a name="myfootnote5">5</a>  Stinson, D.R. <em>Cryptography - Theory and Practice</em>. CRC Press, Boca Raton, FA, 1995, ISBN 0-8493-8521-0.</p>

	  
	  <style>
  .feedback--answer {
    display: inline-block;
  }
  .feedback--answer-no {
    margin-left: 1em;
  }
  .feedback--response {
    display: none;
    margin-top: 1em;
  }
  .feedback--response__visible {
    display: block;
  }
</style>
<div>
<h2 class="feedback--title">Feedback</h2>
<p class="feedback--question">Was this page helpful?</p>
<button class="btn-primary mb-5 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn-primary mb-5 feedback--answer feedback--answer-no">No</button>
<p class="feedback--response feedback--response-yes">
  Glad to hear it!</a>
</p>
<p class="feedback--response feedback--response-no">
  Sorry to hear that.</a>
</p>
</div>
<script>
  const yesButton = document.querySelector('.feedback--answer-yes');
  const noButton = document.querySelector('.feedback--answer-no');
  const yesResponse = document.querySelector('.feedback--response-yes');
  const noResponse = document.querySelector('.feedback--response-no');
  const disableButtons = () => {
    yesButton.disabled = true;
    noButton.disabled = true;
  };
  const sendFeedback = (value) => {
    if (typeof ga !== 'function') return;
    const args = {
      command: 'send',
      hitType: 'event',
      category: 'Helpful',
      action: 'click',
      label: window.location.pathname,
      value: value
    };
    ga(args.command, args.hitType, args.category, args.action, args.label, args.value);
  };
  yesButton.addEventListener('click', () => {
    yesResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(1);
  });
  noButton.addEventListener('click', () => {
    noResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(0);
  });
</script>

	  <br />
	
  </div>
</section>
<footer class="navbar site-footer fixed-bottom py-0">
  <ul class="mx-auto">
    
    <li class="navbar-text" data-toggle="tooltip" data-placement="top" title="Mailing lists" aria-label="Mailing lists">
      <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://lists.ntp.org/listinfo">
        <i class="bi-envelope"></i>
      </a>
    </li>
    
    <li class="navbar-text" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
      <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ntp">
        <i class="bi-twitter"></i>
      </a>
    </li>
    
    <li class="navbar-text" data-toggle="tooltip" data-placement="top" title="LinkedIn" aria-label="LinkedIn">
      <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/groups/4651343">
        <i class="bi-linkedin"></i>
      </a>
    </li>
    
    <li class="navbar-text" data-toggle="tooltip" data-placement="top" title="Facebook" aria-label="Facebook">
      <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/networktimeprotocol">
        <i class="bi-facebook"></i>
      </a>
    </li>
    
    <li class="navbar-text">
      <p>&copy; 2021 <a class="navbar-text text-white" href="https://www.nwtime.org">Network Time Foundation</a></p>	
    </li>
  </ul>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>









<script src="/js/main.min.edda36f11310414202808e2ac1dd0640e32cfff39126d93bd3d8a899e091711f.js" integrity="sha256-7do28RMQQUICgI4qwd0GQOMs//ORJtk709iomeCRcR8=" crossorigin="anonymous"></script>



  </body>
</html>