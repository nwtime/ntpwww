<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="UTF-8">
  <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW"><link rel="canonical" href="https://doc.ntp.org/ntpfaq/ntp-s-algo-crypt/" />
  
  <meta property="og:title" content="5.4. Encryption" />
<meta property="og:description" content="This section of the NTP FAQ discusses the use of encryption and related technology for NTP." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://doc.ntp.org/ntpfaq/ntp-s-algo-crypt/" /><meta property="og:image" content="https://doc.ntp.org/images/NTPLogo800x418.webp"/><meta property="article:section" content="ntpfaq" />

<meta property="article:modified_time" content="2022-06-27T16:22:20&#43;01:00" /><meta property="og:site_name" content="NTP: Network Time Protocol" />


<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://doc.ntp.org/images/NTPLogo800x418.webp"/>

<meta name="twitter:title" content="5.4. Encryption"/>
<meta name="twitter:description" content="This section of the NTP FAQ discusses the use of encryption and related technology for NTP."/>




<script async src="https://www.googletagmanager.com/gtag/js?id=G-K07ZJQFYSZ"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-K07ZJQFYSZ', { 'anonymize_ip': true });
</script>





<script>
window.onload = demo;
function demo() {
    document.getElementById("gsc-i-id1").setAttribute("placeholder", "Search...")
}
</script>


<script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "c33igkoodm");
</script>


  
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700,800,800i,900i&display=swap" rel="stylesheet"/>
   
  <title>5.4. Encryption</title>

  <!-- Mobile Responsive Meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="This section of the NTP FAQ discusses the use of encryption and related technology for NTP.">
  
  <meta name="generator" content="Hugo 0.83.1" />

  <!-- Plugins -->
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://doc.ntp.org/scss/nwtime.min.4076252e84f6b88920097824ca49d445.css" media="screen">

  <!-- Favicon -->
  <link rel="shortcut icon" href="https://doc.ntp.org/favicons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="https://doc.ntp.org/favicons/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="https://doc.ntp.org/favicons/android-chrome-512x512.png" sizes="512x512"></head>
<body><!-- navigation -->

<nav class="navbar navbar-expand-lg navbar-light">
  <div class="container-fluid">


	<div>
	  <a class="navbar-brand" href="https://www.nwtime.org"><img height="80" width="80" src="https://doc.ntp.org/images/logo.png" alt=""></a>
	  <a class="navbar-brand" href="https://doc.ntp.org/"><img height="80" width="80" src="https://doc.ntp.org/images/ntp_logo.jpg" alt="NTP: Network Time Protocol"></a> 
    </div>


    <div>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://doc.ntp.org/support/">Support</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://doc.ntp.org/reflib/">Reference Library</a>
        </button>
      
		<button class="btn btn-light btn-lg" type="button" aria-expanded="false"><a class="nav-item" style="text-decoration: none; text-transform: uppercase" href="https://doc.ntp.org/current-stable/">Documentation</a>
        </button>
      
    </div>



<script async src="https://cse.google.com/cse.js?cx=bb3c9b3e375d856be"></script>
  <div class="gcse-search">
  </div>

</nav>


  <div class="header-border">
  </div>
<!-- /navigation --><nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		







<li class="breadcrumb-item" >
	<a href="https://doc.ntp.org/ntpfaq/">The NTP FAQ and HOWTO</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://doc.ntp.org/ntpfaq/ntp-s-algo-crypt/">5.4. Encryption</a>
</li>

	</ol>
</nav	>


<section class="section pt-0  pb-auto">
  <div class="container">
  	<h1>5.4. Encryption</h1> 
    <p style="font-size: small; color: grey;">Last update: June 27, 2022 16:22 UTC (<a href="https://bitbucket.nwtime.org/projects/WEBSITES/repos/ntpwww/commits/1a7aee0a0bed1662a9f219fcaea42e57cff5d0b3">1a7aee0a0</a>)</p>
	<p>This section discusses the use of encryption and related technology for NTP.</p>
<p>Providing or enabling the use of encryption in software was considered harmful by the USA. However electronic commerce is only possibly with safe data exchange, so use of encryption has become a bit more allowed. NTP version 4 includes no cryptography, from the viewpoint of government regulations, and introduces MD5 keys.</p>
<p>As MD5 is heavily used in digital signatures, MD5 is not considered as cryptography, despite the fact that digital signatures actually <em>do</em> use encryption.</p>
<hr>
<p>5.4.1 <a href="#541-what-is-encryption-used-for-in-ntp">What is Encryption used for in NTP?</a><br>
5.4.1.1 <a href="#5411-how-is-authenticity-verified">How is Authenticity verified?</a><br>
5.4.1.2 <a href="#5412-where-are-authenticated-messages-used-in-ntp">Where are authenticated Messages used in NTP?</a><br>
5.4.1.3 <a href="#5413-how-is-performance-affected-by-encryption">How is Performance affected by Encryption?</a><br>
5.4.2 <a href="#542-the-basics-of-autokey">The Basics of Autokey</a><br>
5.4.2.1 <a href="#5421-authentic-and-proventic">Authentic and Proventic</a><br>
5.4.2.2 <a href="#5422-secure-group-and-trusted-host">Secure Group and Trusted Host</a><br>
5.4.2.3 <a href="#5423-identity-schemes">Identity Schemes</a><br>
5.4.2.4 <a href="#5424-proventic-trail">Proventic Trail</a><br>
5.2.4.5 <a href="#5425-session-keys">Session Keys</a></p>
<hr>
<h4 id="541-what-is-encryption-used-for-in-ntp">5.4.1 What is Encryption used for in NTP?</h4>
<p>Basically NTP uses encryption only for integrity checking and authentication:</p>
<ul>
<li>Symmetric keys (shared secrets) are used to prove authenticity of data received over the network.</li>
<li>Key pairs are used where establishing shared secrets is difficult. The autokey mechanism uses key pairs.</li>
</ul>
<hr>
<h4 id="5411-how-is-authenticity-verified">5.4.1.1 How is Authenticity verified?</h4>
<p>Cryptographic hash functions like MD5 have the following properties:</p>
<ul>
<li>A large amount of input data produces a small fingerprint (output data).</li>
<li>Different input creates different output.</li>
<li>It&rsquo;s not possible to construct some input matching a specific output other than by brute force, or trying at least as many combinations of input that correspond to the key space of the output.</li>
</ul>
<p>The sender computes a <em>fingerprint</em> consisting of public data plus some secret data (the <em>symmetric key</em>), and adds it to the data being transferred. The recipient uses the received data plus the <em>shared secret</em> to compute its own fingerprint in the same way as the sender. Providing a correct fingerprint implies that the sender knows the shared secret, and that the data received wan&rsquo;t changed during transmission.</p>
<p>While the above procedure is not considered to be data encryption, the following procedure using <em>key pairs</em> is: the sender computes a fingerprint of the public data only, but then encrypts that fingerprint with its secret <em>private key</em> of the key pair. Message plus encrypted fingerprint are sent. The recipient decrypts the fingerprint using its <em>public key</em> and compares it the fingerprint computed locally from the public data. If both are the same, it is believed that it&rsquo;s only possible to send the correct encrypted fingerpint when knowing the secret key.</p>
<p>Refer to <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)">this article</a> for an overview of the mathematical properties and generation of key pairs.</p>
<hr>
<h4 id="5412-where-are-authenticated-messages-used-in-ntp">5.4.1.2 Where are authenticated Messages used in NTP?</h4>
<p>The uses of authenticated messages in NTP are:</p>
<ul>
<li>Remote configuration commands.</li>
<li>Time messages (authentication is optional).</li>
</ul>
<hr>
<h4 id="5413-how-is-performance-affected-by-encryption">5.4.1.3 How is Performance affected by Encryption?</h4>
<p>Strong cryptography is computationally expensive. Furthermore, the time required to complete the computations may depend on the actual values being processed in a non-predictable way.</p>
<p>NTP tries to avoid cryptography whenever possibe. MD5 is believed to require almost constant CPU cycles, while public key algorithms are known to require significantly more, and a varying number of CPU cycles.</p>
<hr>
<h4 id="542-the-basics-of-autokey">5.4.2 The Basics of Autokey</h4>
<p>Symmetric key encryption requires a secure channel to exchange secret keys. Every NTP client needs a secret key for authenticating the time messages from a server. Public key cryptography and X.509 version 3 certificates are used for the <a href="https://doc.ntp.org/reflib/rfc/rfc5906.txt">Autokey</a> authentication schema that is summarized below. See <a href="https://doc.ntp.org/ntpfaq/ntp-s-config-adv/#6226-how-do-i-use-public-key-authentication-autokey">Q: 6.2.2.6</a> for configuration details.</p>
<p>As public key algorithms are computationally expensive, those algorithms are not used for every packet being exchanged.</p>
<hr>
<h4 id="5421-authentic-and-proventic">5.4.2.1 Authentic and Proventic</h4>
<p>In <a href="https://doc.ntp.org/reflib/brief/autokey/autokey.pdf">NTP Security Model</a> the phrases are defined like this:</p>
<dl>
<dt>authentic</dt>
<dd>A client is authentic if it can reliably verify the credentials of at least one server and the integrity of its messages.</dd>
<dt>proventic</dt>
<dd>A client is proventic if there exists a path to a trusted server where each node is authentic.</dd>
</dl>
<hr>
<h4 id="5422-secure-group-and-trusted-host">5.4.2.2 Secure Group and Trusted Host</h4>
<p>A <em>secure group</em> defines a subset of the NTP network that uses a common <em>security model</em>, <em>authentication protocol</em>, and <em>identity scheme</em>. Each member of a group has <em>identity parameters</em> and a <em>group key</em> provided by some <em>trusted agent</em>.</p>
<p>Each secure group has at least one <em>trusted host</em> that operates as <em>certificate authority</em> at the lowest stratum of the group.</p>
<p>A <em>primary group</em> includes at least one trusted primary server (stratum 1).</p>
<hr>
<h4 id="5423-identity-schemes">5.4.2.3 Identity Schemes</h4>
<p><em>Identity Schemes</em> are methods to prove the identity of a remote system, helping to prevent <em>man-in-the-middle attacks</em>. In <a href="https://doc.ntp.org/reflib/brief/secalgor/secalgor.pdf">NTP Security Algorithms</a> and <a href="https://doc.ntp.org/reflib/brief/autokey/autokey.pdf">NTP Security Model</a> the following identity schemes are mentioned:</p>
<ul>
<li><strong>Private Certificate (PC):</strong> much like private keys, requiring a secret channel to distribute keys.</li>
<li><strong>Trusted Certificate (TC):</strong> uses a trusted authority (TA) and certificate chains.</li>
<li><strong>Schnorr Identity Scheme (IFF):</strong> uses DSA principles.</li>
<li><strong>Guillou-Quisquater Identity Scheme (GQ):</strong> based on RSA principles.</li>
<li><strong>Mu-Varadharajan Identity Scheme (MV):</strong> based on DSA principles, but does not require trusted clients.</li>
</ul>
<p>All schemes use relatively small keys (few bits), so those keys must be refreshed regularly. Even though certificates are valid for one year after creation, the keys should be re-created on a shorter interval. Using the NTP timestamp as the certificate&rsquo;s serial number ensures uniqueness. Thus signatures are only generated when the host&rsquo;s time is considered synchronized.</p>
<hr>
<h4 id="5424-proventic-trail">5.4.2.4 Proventic Trail</h4>
<p>According to <a href="https://doc.ntp.org/reflib/brief/secproto/secproto.pdf">NTP Security Protocol</a>, a <em>proventic trail</em> (certificate trail) is a cryptographically verified sequence of NTP servers ending at a trusted host.</p>
<hr>
<h4 id="5425-session-keys">5.4.2.5 Session Keys</h4>
<p>According to <a href="https://doc.ntp.org/reflib/brief/secproto/secproto.pdf">NTP Security Protocol</a>, <em>session keys</em> are 128 bits (16 octets). Session keys are created as lists of keys, and the last key in the list is digitally signed. See <a href="https://www.rfc-editor.org/rfc/rfc2104">RFC 2104 HMAC: Keyed-Hashing for Message Authentication</a> for basics.</p>

	  
  </div>
</section>
<nav class="site-footer navbar navbar-expand-sm mt-auto">
  <div class="container">
      <ul class="navbar-nav">
        
        <li class="nav-item" title="Twitter" aria-label="Twitter">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ntp">
          <img src="https://doc.ntp.org/images/icons/twitter.svg" width="20" height="20"></img>
          </a>
       </li>
       
        <li class="nav-item" title="LinkedIn" aria-label="LinkedIn">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/groups/4651343">
          <img src="https://doc.ntp.org/images/icons/linkedin.svg" width="20" height="20"></img>
          </a>
       </li>
       
        <li class="nav-item" title="Facebook" aria-label="Facebook">
          <a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/networktimeprotocol">
          <img src="https://doc.ntp.org/images/icons/facebook.svg" width="20" height="20"></img>
          </a>
       </li>
       
	  </ul>
	  <ul class="mx-auto pt-3">
        <p>&copy; 2023 <a class="navbar-text text-white" href="https://www.nwtime.org/">Network Time Foundation</a></p>	
      </ul>
    </div>
</nav>
</body>
</html>